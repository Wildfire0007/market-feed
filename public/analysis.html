<!doctype html><meta charset='utf-8'><title>Analysis Summary</title><h1>Analysis Summary (TD-only)</h1><pre>{
  "ok": true,
  "generated_utc": "2025-12-30T03:01:31Z",
  "analysis_started_utc": "2025-12-30T03:01:31Z",
  "assets": {
    "EURUSD": {
      "asset": "EURUSD",
      "ok": true,
      "retrieved_at_utc": "2025-12-30T03:01:31Z",
      "source": "Twelve Data (lokális JSON)",
      "spot": {
        "price": 1.17742,
        "utc": "2025-12-30T03:01:16Z",
        "retrieved_at_utc": "2025-12-30T03:01:16Z",
        "source": "twelvedata:quote",
        "realtime_override": false,
        "fallback_used": false,
        "confidence": 1.0,
        "avg_latency_profile": 15.0,
        "realtime_stats": null
      },
      "signal": "no entry",
      "probability": 40,
      "probability_raw": 40,
      "entry": 1.17742,
      "sl": 1.1656457999999998,
      "tp1": 1.19861356,
      "tp2": 1.20921034,
      "rr": 2.7,
      "leverage": 30.0,
      "position_size_scale": 0.0625,
      "range_time_stop": {
        "timeout": 20,
        "breakeven_trigger": 0.3,
        "giveback_ratio": 0.4
      },
      "funding_filter": null,
      "funding_rate": null,
      "stale_timeframes": {
        "k1m": false,
        "k5m": false,
        "k1h": false,
        "k4h": false
      },
      "biases": {
        "raw_4h": "long",
        "raw_1h": "long",
        "adjusted_4h": "long",
        "adjusted_1h": "long"
      },
      "gates": {
        "mode": "core",
        "required": [
          "session",
          "spread_guard",
          "data_integrity",
          "risk_reward",
          "structure(2of3)",
          "intraday_range_guard",
          "atr",
          "rr_math>=1.4",
          "tp_min_profit",
          "min_stoploss",
          "tp1_net>=+0.1%",
          "precision_score>=55",
          "precision_trigger_sync"
        ],
        "missing": [],
        "session_window_status": {
          "entry_open": true,
          "monitor_window": true,
          "status": "open",
          "status_note": "Piac nyitva",
          "összefoglaló": "Entry ablak NYITVA, Megfigyelés aktív"
        }
      },
      "gate_skips": [
        "liquidity_no_data",
        "orderflow_no_data"
      ],
      "session_info": {
        "open": true,
        "entry_open": true,
        "within_window": true,
        "within_entry_window": true,
        "within_monitor_window": true,
        "weekday_ok": true,
        "now_utc": "2025-12-30T03:01:31.135558+00:00",
        "now_budapest": "2025-12-30T04:01:31.135558+01:00",
        "windows_utc": [
          [
            0,
            0,
            23,
            55
          ]
        ],
        "time_zone": "Europe/Berlin",
        "time_zone_budapest": "Europe/Budapest",
        "windows_local_cet": [
          [
            "01:00",
            "00:55"
          ]
        ],
        "windows_local_budapest": [
          [
            "01:00",
            "00:55"
          ]
        ],
        "allowed_weekdays": [
          0,
          1,
          2,
          3,
          4,
          6
        ],
        "status_profile": "default",
        "sunday_open_utc": "23:05",
        "sunday_open_budapest": "00:05",
        "minutes_to_session_close": 1139,
        "session_close_reason": "daily_break",
        "next_session_open_utc": "2025-12-31T00:00:00+00:00",
        "next_session_open_budapest": "2025-12-31T01:00:00+01:00",
        "status": "open",
        "status_note": "Piac nyitva",
        "notes": [
          "Alapértelmezett session profil — valós idejű nyitvatartási szabályok érvényesek"
        ],
        "next_open_utc": "2025-12-31T00:00:00+00:00"
      },
      "momentum_diagnostics": {
        "evaluated": true,
        "used_for_decision": false,
        "direction_result": null,
        "required": [
          "session",
          "regime",
          "bias",
          "momentum_trigger",
          "structure(2of3)",
          "atr",
          "rr_math>=1.2",
          "tp_min_profit",
          "min_stoploss",
          "tp1_net>=+0.1%",
          "intraday_range_guard"
        ],
        "missing": [
          "regime",
          "atr",
          "momentum_trigger"
        ],
        "liquidity_data_available": false,
        "flow_data_available": false,
        "ofi_available": false,
        "momentum_trigger_ok": null,
        "momentum_atr_ok": false,
        "trigger_desc": null,
        "precision_data_gap_mode": false
      },
      "diagnostics": {
        "timeframes": {
          "k1m": {
            "last_raw_utc": "2025-12-30T03:00:00Z",
            "last_closed_utc": "2025-12-30T03:00:00Z",
            "latency_seconds": 91,
            "expected_max_delay_seconds": 180,
            "source_mtime_utc": "2025-12-30T03:01:27Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 240.0,
            "freshness_violation": false,
            "freshness_retries": 0,
            "used_symbol": "EUR/USD",
            "used_exchange": "PHYSICAL CURRENCY",
            "retrieved_at_utc": "2025-12-30T03:01:27Z",
            "latency_guard_seconds": 87,
            "latency_guard_adjustment_seconds": 4,
            "critical_stale": false
          },
          "k5m": {
            "last_raw_utc": "2025-12-30T03:00:00Z",
            "last_closed_utc": "2025-12-30T03:00:00Z",
            "latency_seconds": 91,
            "expected_max_delay_seconds": 300,
            "source_mtime_utc": "2025-12-30T03:01:20Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 900.0,
            "freshness_violation": false,
            "freshness_retries": 0,
            "used_symbol": "EUR/USD",
            "used_exchange": "PHYSICAL CURRENCY",
            "retrieved_at_utc": "2025-12-30T03:01:20Z",
            "latency_guard_seconds": 80,
            "latency_guard_adjustment_seconds": 11,
            "critical_stale": false
          },
          "k1h": {
            "last_raw_utc": "2025-12-30T03:00:00Z",
            "last_closed_utc": "2025-12-30T03:00:00Z",
            "latency_seconds": 91,
            "expected_max_delay_seconds": 3600,
            "source_mtime_utc": "2025-12-30T03:01:23Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 5400.0,
            "freshness_violation": false,
            "freshness_retries": 0,
            "used_symbol": "EUR/USD",
            "used_exchange": "PHYSICAL CURRENCY",
            "retrieved_at_utc": "2025-12-30T03:01:23Z",
            "latency_guard_seconds": 83,
            "latency_guard_adjustment_seconds": 8,
            "critical_stale": false
          },
          "k4h": {
            "last_raw_utc": "2025-12-30T00:00:00Z",
            "last_closed_utc": "2025-12-30T00:00:00Z",
            "latency_seconds": 10891,
            "expected_max_delay_seconds": 14400,
            "source_mtime_utc": "2025-12-30T03:01:25Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 21600.0,
            "freshness_violation": false,
            "freshness_retries": 0,
            "used_symbol": "EUR/USD",
            "used_exchange": "PHYSICAL CURRENCY",
            "retrieved_at_utc": "2025-12-30T03:01:25Z",
            "latency_guard_seconds": 10885,
            "latency_guard_adjustment_seconds": 6,
            "critical_stale": false
          },
          "spot": {
            "last_raw_utc": "2025-12-30T03:01:16Z",
            "latency_seconds": 15,
            "expected_max_delay_seconds": 900,
            "source_mtime_utc": "2025-12-30T03:01:27Z",
            "source": "twelvedata:quote",
            "fallback_used": false,
            "realtime_override": false,
            "freshness_limit_seconds": 900.0,
            "freshness_retries": 0,
            "freshness_violation": false,
            "freshness_violation_meta": false,
            "used_symbol": "EUR/USD",
            "used_exchange": "PHYSICAL CURRENCY"
          }
        },
        "source_files": {
          "spot.json": "2025-12-30T03:01:27Z",
          "klines_1m.json": "2025-12-30T03:01:27Z",
          "klines_5m.json": "2025-12-30T03:01:20Z",
          "klines_1h.json": "2025-12-30T03:01:23Z",
          "klines_4h.json": "2025-12-30T03:01:25Z"
        },
        "latency_flags": [],
        "refresh_tips": [
          "Az analysis.py mindig a legutóbbi ZÁRT gyertyával számol (5m: max. ~5 perc késés).",
          "CI/CD-ben kösd össze a Trading és Analysis futást: az analysis job csak a trading után induljon (needs: trading).",
          "A kliens kéréséhez adj cache-busting query paramot (pl. ?v=<timestamp>) és no-store cache-control fejlécet.",
          "Cloudflare Worker stale policy: 5m feedre állítsd 120s-re, hogy hamar átjöjjön az új jel.",
          "A dashboard stabilizáló (2 azonos jel + 10 perc cooldown) lassíthatja a kártya frissítését — lazítsd, ha realtime kell."
        ]
      },
      "reasons": [
        "Bias(4H→1H)=long (+15.0)",
        "Regime filter inaktív",
        "5M BOS trendirányba (+16.0)",
        "ATR nincs rendben (relatív vagy abszolút küszöb)",
        "Alacsony realised vol → magasabb RR igény",
        "Range expanzió támogatja a momentumot (+3.0)",
        "Fib zóna konfluencia (0.618–0.886) (+18.0)",
        "EURUSD: ATR(1h) alacsony — P-score küszöb +6 pontra emelve",
        "EURUSD: Visszafogott ATR — célok szűkítve, kockázat kontroll alatt",
        "EURUSD BOS aktív, de VWAP alatt — türelem",
        "ATR-floor override: rel_atr 0.0002 < 0.0006 → adaptív RR/TP küszöb",
        "Regime kapu: CHOPPY miatt −10 P-score, pozícióskálázás csökkentve",
        "ATR soft gate: alacsony volatilitás −5 P-score, méret felezve",
        "Strukturális kapu lazítva: momentum erős, BOS hiány engedve",
        "Liquidity gate skipped (no volume proxy available)",
        "Order-flow gates skipped (no tick/imbalance data)"
      ],
      "realtime_transport": "http",
      "data_integrity_diagnostics": {
        "core_data_ok": true,
        "precision_data_ok": true,
        "precision_disabled_due_to_data_gap": false,
        "core_required_sources": [
          "spot",
          "k5m"
        ],
        "precision_required_sources": [
          "spot",
          "k5m",
          "k1m"
        ],
        "spot": {
          "last_raw_utc": "2025-12-30T03:01:16Z",
          "latency_seconds": 15,
          "expected_max_delay_seconds": 900,
          "source_mtime_utc": "2025-12-30T03:01:27Z",
          "source": "twelvedata:quote",
          "fallback_used": false,
          "realtime_override": false,
          "freshness_limit_seconds": 900.0,
          "freshness_retries": 0,
          "freshness_violation": false,
          "freshness_violation_meta": false,
          "used_symbol": "EUR/USD",
          "used_exchange": "PHYSICAL CURRENCY"
        },
        "k5m": {
          "last_raw_utc": "2025-12-30T03:00:00Z",
          "last_closed_utc": "2025-12-30T03:00:00Z",
          "latency_seconds": 91,
          "expected_max_delay_seconds": 300,
          "source_mtime_utc": "2025-12-30T03:01:20Z",
          "stale_for_signals": false,
          "freshness_limit_seconds": 900.0,
          "freshness_violation": false,
          "freshness_retries": 0,
          "used_symbol": "EUR/USD",
          "used_exchange": "PHYSICAL CURRENCY",
          "retrieved_at_utc": "2025-12-30T03:01:20Z",
          "latency_guard_seconds": 80,
          "latency_guard_adjustment_seconds": 11,
          "critical_stale": false
        },
        "k1m": {
          "last_raw_utc": "2025-12-30T03:00:00Z",
          "last_closed_utc": "2025-12-30T03:00:00Z",
          "latency_seconds": 91,
          "expected_max_delay_seconds": 180,
          "source_mtime_utc": "2025-12-30T03:01:27Z",
          "stale_for_signals": false,
          "freshness_limit_seconds": 240.0,
          "freshness_violation": false,
          "freshness_retries": 0,
          "used_symbol": "EUR/USD",
          "used_exchange": "PHYSICAL CURRENCY",
          "retrieved_at_utc": "2025-12-30T03:01:27Z",
          "latency_guard_seconds": 87,
          "latency_guard_adjustment_seconds": 4,
          "critical_stale": false
        }
      },
      "profile_resolution": {
        "asset": "EURUSD",
        "entry_profile": "baseline",
        "global_default_profile": null,
        "schedule_enabled": true,
        "schedule_bucket": "mid",
        "schedule_selected_profile": "baseline",
        "resolution_notes": [
          "profile via schedule bucket mid -> baseline"
        ]
      },
      "effective_thresholds": {
        "asset": "EURUSD",
        "entry_profile": "baseline",
        "p_score_min": 34.0,
        "spread_max_atr_pct": 0.7,
        "tp_net_min": 0.001,
        "rr_required": 1.35,
        "tp_min_profit_pct": 0.0013,
        "min_stoploss_pct": 0.01,
        "atr_abs_min_used": 0.00022,
        "atr_low_threshold": 0.0002063960515865809,
        "atr_overlay_min": null,
        "bos_lookback": 28,
        "fib_tolerance": 0.008,
        "position_scale_floor": 0.05,
        "staleness_max_age_seconds": 900,
        "session_window": {
          "entry": [
            [
              0,
              0,
              23,
              55
            ]
          ],
          "monitor": [
            [
              0,
              0,
              23,
              55
            ]
          ]
        }
      },
      "probability_model_source": "sklearn",
      "probability_model": null,
      "probability_model_raw": null,
      "probability_calibrated": null,
      "probability_threshold": null,
      "probability_stack": {
        "source": "sklearn",
        "status": "disabled",
        "unavailable_reason": "ml_scoring_disabled"
      },
      "ema21_slope_1h": -0.00018808822203199638,
      "ema21_slope_threshold": 0.011,
      "ema21_relation_1h": "above",
      "last_swing_high_1h": 1.17573,
      "last_swing_low_1h": 1.17699,
      "last_close_1h": 1.17736,
      "bos_5m_dir": "bos_down",
      "atr1h": 0.0008492857142856953,
      "momentum_volume_ratio": null,
      "momentum_liquidity_ok": true,
      "dynamic_tp_profile": {
        "core": {
          "tp1": 1.8,
          "tp2": 2.7,
          "rr": 1.3650000000000002
        },
        "momentum": {
          "tp1": 1.5,
          "tp2": 2.4,
          "rr": 1.2075
        },
        "regime": "compressed",
        "reference": {
          "current": 0.00018153846153850644,
          "q20": 0.00017538461538459265,
          "q50": 0.0002507692307692595,
          "q80": 0.000338153846153824
        }
      },
      "order_flow_metrics": {
        "imbalance": null,
        "pressure": 0.0,
        "delta_volume": 0.0,
        "aggressor_ratio": null,
        "imbalance_z": null,
        "status": "ok"
      },
      "intraday_profile": {
        "asset": "EURUSD",
        "timestamp": "2025-12-30T03:01:31Z",
        "day_start_utc": "2025-12-29T23:00:00Z",
        "day_open": 1.17685,
        "day_high": 1.17768,
        "day_low": 1.17685,
        "day_range": 0.0008300000000001084,
        "range_vs_atr": 4.572033898304551,
        "range_position": 0.6867469879516687,
        "range_bias": "upper",
        "range_state": "expansion",
        "range_compression": false,
        "range_expansion": true,
        "range_exhaustion_long": false,
        "range_exhaustion_short": false,
        "range_guard": {
          "long": false,
          "short": false
        },
        "micro_range_position": 0.37254901960766384,
        "micro_range_vs_atr": 2.8093220338976677,
        "micro_range_guard": {
          "long": false,
          "short": false
        },
        "opening_range_high": 1.17751,
        "opening_range_low": 1.17685,
        "opening_break": "none",
        "opening_range_minutes": 45,
        "opening_drive_ratio": 0.7951807228915888,
        "previous_close": 1.17685,
        "opening_gap": 0.0,
        "opening_gap_pct": 0.0,
        "opening_gap_direction": "flat",
        "price_reference": 1.17742,
        "elapsed_minutes": 241,
        "notes": [
          "Range expanzió >1.5×ATR — agresszív menedzsment indokolt."
        ]
      },
      "entry_thresholds": {
        "profile": "baseline",
        "eurusd_overrides": {
          "vwap_alignment": {
            "distance": null,
            "above": false,
            "below": false,
            "bos_long": true,
            "bos_short": true
          },
          "atr1h_pips": 8.492857142856954,
          "p_score_adjustments": {
            "low_vol_add": 6.0
          },
          "rr_bias": {
            "mode": "low_vol",
            "atr1h_pips": 8.492857142856954
          },
          "position_scale": {
            "atr_basis": 0.0008492857142856953,
            "raw_scale": 1.88393608074016,
            "applied": 1.0
          }
        },
        "news_lockout": false,
        "adx_value": 11.175904929111638,
        "adx_trend_threshold": 20.0,
        "adx_regime_initial": "range",
        "atr_multiplier": 0.0,
        "atr_threshold_base": 0.0,
        "atr_threshold_initial": 0.0,
        "atr_intraday_relax": 0.9,
        "atr_threshold_intraday": 0.0,
        "atr_percentile_meta": {
          "bucket": "mid",
          "samples": 192,
          "percentile": 0.25,
          "threshold": 0.0002063960515865809
        },
        "atr_threshold_percentile": 0.0002063960515865809,
        "spread_ratio": null,
        "atr_soft_gate": {
          "enabled": true,
          "rel_atr": 0.00015418326641173622,
          "threshold": 0.0002063960515865809,
          "tolerance_pct": 0.15,
          "penalty_max": 6.0,
          "diff_ratio": 0.25297375978601017,
          "mode": "fail"
        },
        "atr_ratio_ok": false,
        "atr_threshold_effective": 0.0002063960515865809,
        "spread_gate_ok": true,
        "atr_abs_min_used": 0.00022,
        "atr_abs_override_applied": false,
        "risk_guard": {
          "profile": "baseline",
          "max_risk_pct": 1.6,
          "spread_gate_ok": true,
          "allowed": true,
          "cost_model": {
            "type": "pip",
            "round_trip_pips": 1.2,
            "overnight_pips": 0.4
          }
        },
        "fib_tolerance_fraction": 0.008,
        "dynamic_score_engine": {
          "base_score": 55.0,
          "final_score": 55.0
        },
        "ofi_z": null,
        "vwap_confluence": {
          "trend_pullback": false,
          "mean_revert": false
        },
        "structure_components": {
          "bos": false,
          "liquidity": true,
          "ofi": false
        },
        "p_score_min_base": 28.0,
        "bias_meta": "long",
        "bias_micro": null,
        "p_score_min_effective": 34.0,
        "range_giveback_ratio": 0.4,
        "adx_regime": "range",
        "position_size_scale": 0.5,
        "rr_min_core": 1.35,
        "rr_min_momentum": 1.2075,
        "rr_meta": {
          "core_rr_min_base": 1.35,
          "momentum_rr_min_base": 1.2075,
          "low_atr_override": {
            "floor": 0.0006,
            "rel_atr": 0.00015418326641173622,
            "tp_min_pct": 0.0015,
            "rr_required": 1.35,
            "core_rr_min_effective": 1.35,
            "momentum_rr_min_effective": 1.2075
          },
          "core_rr_min": 1.35,
          "momentum_rr_min": 1.2075
        },
        "low_atr_override": {
          "floor": 0.0006,
          "rel_atr": 0.00015418326641173622,
          "tp_min_pct": 0.0015,
          "rr_required": 1.35,
          "tp_min_pct_override": 0.0015,
          "tp_min_pct_effective": 0.0013,
          "rr_required_effective": 1.35
        },
        "precision_gate_state": {
          "score_ready": true,
          "score": 62.0,
          "threshold": 55.0,
          "flow_ready": false,
          "trigger_ready": true,
          "trigger_state": "fire",
          "flow_blockers": [],
          "profile": "baseline",
          "position_sizing_floor": 0.01,
          "precision_state": "none",
          "precision_soft_block": false,
          "precision_profile": "baseline",
          "btc_precision_threshold": 52.0,
          "precision_ready_since": null,
          "precision_arming_since": null,
          "precision_events": 1,
          "precision_hits_ready": 0,
          "precision_hits_arming": 0,
          "precision_hits_soft_block": 0
        },
        "precision_score_threshold": 55.0,
        "precision_timeouts": {
          "ready": 15,
          "arming": 20
        }
      },
      "entry_gate_context_hu": {
        "atr_kapu": {
          "ok": false,
          "rel_atr": 0.00015418326641173622,
          "threshold": 0.0002063960515865809,
          "abs_ok": false,
          "overlay_ok": false,
          "btc_atr_gate": true,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "spread_kapu": {
          "ok": true,
          "spread_ratio_atr": null,
          "spread_limit_atr": 0.7,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "kockazat_guard": {
          "max_risk_pct": 1.6,
          "engedi": true,
          "cost_model": {
            "type": "pip",
            "round_trip_pips": 1.2,
            "overnight_pips": 0.4
          },
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "profil_kuszobok": {
          "profil": "baseline",
          "p_score_min": 28.0,
          "p_score_min_base": 28.0,
          "atr_kuszob_rel": 0.0002063960515865809,
          "atr_abs_min": 0.00022,
          "fib_tures_frac": 0.008,
          "fib_tures_atr": 0.0006369642857142715,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "bos_visszatekintes": 28,
        "fib_zona": {
          "ok": true,
          "sav": [
            0.618,
            0.886
          ],
          "tures_frac": 0.008,
          "tures_atr": 0.0006369642857142715,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "session_ablak_utc": {
          "entry": [
            [
              0,
              0,
              23,
              55
            ]
          ],
          "monitor": [
            [
              0,
              0,
              23,
              55
            ]
          ]
        },
        "p_score_profil": "baseline",
        "structure_kapu": {
          "ok": false,
          "komponensek": {
            "bos": false,
            "liquidity": true,
            "ofi": false
          },
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "rr_kapuk": {
          "core_rr_min": 1.35,
          "momentum_rr_min": 1.2075,
          "relaxalt": false,
          "indok": null,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "momentum_kapu": {
          "momentum_ok": false,
          "momentum_direction": null,
          "momentum_reason": "missing:atr,momentum_trigger,regime",
          "momentum_missing": [
            "regime",
            "atr",
            "momentum_trigger"
          ],
          "momentum_regime_ok": false,
          "momentum_structure_ok": false,
          "momentum_atr_ok": false,
          "momentum_liquidity_ok": true,
          "momentum_trigger_ok": false,
          "momentum_ofi_z": null,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "precision_kapu": {
          "score_ready": true,
          "score": 62.0,
          "threshold": 55.0,
          "flow_ready": false,
          "trigger_ready": true,
          "trigger_state": "fire",
          "flow_blockers": [],
          "profile": "baseline",
          "position_sizing_floor": 0.01,
          "precision_state": "none",
          "precision_soft_block": false,
          "precision_profile": "baseline",
          "btc_precision_threshold": 52.0,
          "precision_ready_since": null,
          "precision_arming_since": null,
          "precision_events": 1,
          "precision_hits_ready": 0,
          "precision_hits_arming": 0,
          "precision_hits_soft_block": 0,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        }
      },
      "volatility_overlay": {
        "implied_vol": null,
        "realised_vol": 4.7768900442904213e-05,
        "realised_window_minutes": 120,
        "regime": "suppressed",
        "premium": null,
        "source_path": null,
        "implied_realised_ratio": null
      },
      "precision_plan": {
        "asset": "EURUSD",
        "direction": "buy",
        "score": 62.0,
        "confidence": "medium",
        "entry": 1.17742,
        "entry_window": [
          1.1773328615384615,
          1.1774635692307691
        ],
        "stop_loss": 1.1772021538461537,
        "take_profit_1": 1.1778556923076924,
        "take_profit_2": 1.1780735384615386,
        "risk": 0.00021784615384620772,
        "liquidity_levels": [
          1.17747,
          1.17747,
          1.17745,
          1.17744,
          1.17746
        ],
        "factors": [
          "ATR1m 0.0001",
          "ATR5m 0.0002",
          "price near liquidity pocket"
        ],
        "score_threshold": 55.0,
        "score_ready": true,
        "trigger_state": "fire",
        "trigger_ready": true,
        "trigger_levels": {
          "window_low": 1.1773328615384615,
          "window_high": 1.1774635692307691,
          "fire": 1.17742,
          "arm": 1.1774635692307691,
          "disarm": 1.1773328615384615
        },
        "ready_ts": "2025-12-30T02:59:00Z",
        "order_flow_ready": false,
        "order_flow_strength": null,
        "microstructure_score": 62.0,
        "trigger_progress": 1.0,
        "trigger_confidence": 0.54,
        "trigger_reasons": [
          "price hit entry"
        ],
        "order_flow_status": "ok",
        "order_flow_optional": false,
        "order_flow_settings": {
          "imbalance_threshold": 0.6,
          "pressure_threshold": 0.7,
          "imbalance_margin": 1.1,
          "pressure_margin": 1.1,
          "min_signals": 1,
          "strength_floor": 0.74,
          "block_ratio": 0.0
        },
        "order_flow_signals": 0,
        "order_flow_blockers": [],
        "order_flow_stalled": true,
        "alternates": {
          "sell": {
            "direction": "sell",
            "entry": 1.17745,
            "entry_window": [
              1.177406430769231,
              1.1775371384615385
            ],
            "stop_loss": 1.1776678461538463,
            "take_profit_1": 1.1770143076923076,
            "take_profit_2": 1.1767964615384614,
            "risk": 0.00021784615384620772,
            "score": 62.0,
            "confidence": "medium",
            "trigger_levels": {
              "window_low": 1.177406430769231,
              "window_high": 1.1775371384615385,
              "fire": 1.17745,
              "arm": 1.177406430769231,
              "disarm": 1.1775371384615385
            },
            "order_flow_ready": false
          }
        },
        "ready_timeout_minutes": 15,
        "arming_timeout_minutes": 20,
        "context": {
          "intraday_profile": {
            "range_state": "expansion",
            "range_position": 0.6867469879516687,
            "range_vs_atr": 4.572033898304551
          }
        }
      },
      "execution_playbook": [
        {
          "step": "precision_trigger",
          "state": "fire",
          "description": "Precision trigger: fire",
          "entry_window": [
            1.1773328615384615,
            1.1774635692307691
          ],
          "trigger_levels": {
            "window_low": 1.1773328615384615,
            "window_high": 1.1774635692307691,
            "fire": 1.17742,
            "arm": 1.1774635692307691,
            "disarm": 1.1773328615384615
          },
          "ready_ts": "2025-12-30T02:59:00Z",
          "score": 62.0,
          "score_threshold": 55.0,
          "score_ready": true,
          "trigger_ready": true,
          "order_flow_ready": false,
          "order_flow_strength": null,
          "trigger_progress": 1.0,
          "trigger_confidence": 0.54,
          "reasons": [
            "price hit entry"
          ]
        }
      ],
      "invalid_levels": {
        "buy": 1.1765653571428571,
        "sell": 1.1761546428571428
      },
      "invalid_buffer_abs": 0.00042464285714284767,
      "action_plan": {
        "status": "standby",
        "priority": "low",
        "summary": "Nincs belépő – figyeld a következő megerősítést.",
        "steps": [
          {
            "order": 1,
            "category": "precision_trigger",
            "instruction": "Precision trigger: fire",
            "source": "execution_playbook",
            "entry_window": [
              1.1773328615384615,
              1.1774635692307691
            ],
            "trigger_levels": {
              "window_low": 1.1773328615384615,
              "window_high": 1.1774635692307691,
              "fire": 1.17742,
              "arm": 1.1774635692307691,
              "disarm": 1.1773328615384615
            }
          }
        ],
        "blockers": [],
        "blockers_raw": [],
        "notes": [
          "Range expanzió >1.5×ATR — agresszív menedzsment indokolt.",
          "Összesített valószínűség: 40%.",
          "Ajánlott tőkeáttétel: ×30.0.",
          "Célzott RR: 2.70R.",
          "Precision score: 62.00 / küszöb 55.",
          "Precision confidence: medium.",
          "Precision trigger állapot: fire.",
          "Bias(4H→1H)=long (+15.0)",
          "Regime filter inaktív",
          "5M BOS trendirányba (+16.0)",
          "ATR nincs rendben (relatív vagy abszolút küszöb)",
          "Alacsony realised vol → magasabb RR igény",
          "Range expanzió támogatja a momentumot (+3.0)"
        ],
        "context": {
          "asset": "EURUSD",
          "decision": "no entry",
          "probability": 40,
          "session_open": true,
          "session_entry_open": true,
          "session_status": "open",
          "intraday_profile": {
            "range_state": "expansion",
            "range_position": 0.6867469879516687,
            "range_vs_atr": 4.572033898304551,
            "range_guard": {
              "long": false,
              "short": false
            },
            "opening_break": "none"
          },
          "next_session_open_utc": "2025-12-31T00:00:00+00:00",
          "precision_trigger_state": "fire",
          "precision_direction": "buy"
        }
      },
      "entry_diagnostics": {
        "required": [
          "session",
          "spread_guard",
          "data_integrity",
          "risk_reward",
          "structure(2of3)",
          "intraday_range_guard",
          "atr",
          "rr_math>=1.4",
          "tp_min_profit",
          "min_stoploss",
          "tp1_net>=+0.1%",
          "precision_score>=55",
          "precision_trigger_sync"
        ],
        "missing": [],
        "blockers": [],
        "p_score_used": 40
      },
      "position_diagnostics": {
        "state": null,
        "severity": null,
        "reasons": [],
        "p_score_used": 40
      },
      "active_position_meta": {
        "ema21_slope_abs": 0.00018808822203199638,
        "ema21_slope_signed": -0.00018808822203199638,
        "ema21_slope_threshold": 0.011,
        "ema21_relation": "above",
        "structure_5m": "bos_down",
        "stale_timeframes": {
          "k1m": false,
          "k5m": false,
          "k1h": false,
          "k4h": false
        },
        "atr1h": 0.0008492857142856953,
        "atr1h_trail_floor": 0.00042464285714284767,
        "atr5": 0.00018153846153850644,
        "atr5_rel": 0.00015418326641173622,
        "atr5_threshold": 0.0002063960515865809,
        "bos1h_long": true,
        "bos1h_short": false,
        "regime_ok": false,
        "effective_bias": "long",
        "last_close_1h": 1.17736,
        "last_swing_high_1h": 1.17573,
        "last_swing_low_1h": 1.17699,
        "invalid_level_sell": 1.1761546428571428,
        "invalid_level_buy": 1.1765653571428571,
        "invalid_buffer_abs": 0.00042464285714284767,
        "p_score": 40,
        "probability_calibrated": null,
        "probability_threshold": null,
        "probability_model_raw": null,
        "probability_model_source": "sklearn",
        "tp_profile": {
          "tp1_r": 1.8,
          "tp2_r": 2.7
        },
        "realtime_confidence": 1.0,
        "avg_latency_profile": 15.0,
        "precision_plan": {
          "asset": "EURUSD",
          "direction": "buy",
          "score": 62.0,
          "confidence": "medium",
          "entry": 1.17742,
          "entry_window": [
            1.1773328615384615,
            1.1774635692307691
          ],
          "stop_loss": 1.1772021538461537,
          "take_profit_1": 1.1778556923076924,
          "take_profit_2": 1.1780735384615386,
          "risk": 0.00021784615384620772,
          "liquidity_levels": [
            1.17747,
            1.17747,
            1.17745,
            1.17744,
            1.17746
          ],
          "factors": [
            "ATR1m 0.0001",
            "ATR5m 0.0002",
            "price near liquidity pocket"
          ],
          "score_threshold": 55.0,
          "score_ready": true,
          "trigger_state": "fire",
          "trigger_ready": true,
          "trigger_levels": {
            "window_low": 1.1773328615384615,
            "window_high": 1.1774635692307691,
            "fire": 1.17742,
            "arm": 1.1774635692307691,
            "disarm": 1.1773328615384615
          },
          "ready_ts": "2025-12-30T02:59:00Z",
          "order_flow_ready": false,
          "order_flow_strength": null,
          "microstructure_score": 62.0,
          "trigger_progress": 1.0,
          "trigger_confidence": 0.54,
          "trigger_reasons": [
            "price hit entry"
          ],
          "order_flow_status": "ok",
          "order_flow_optional": false,
          "order_flow_settings": {
            "imbalance_threshold": 0.6,
            "pressure_threshold": 0.7,
            "imbalance_margin": 1.1,
            "pressure_margin": 1.1,
            "min_signals": 1,
            "strength_floor": 0.74,
            "block_ratio": 0.0
          },
          "order_flow_signals": 0,
          "order_flow_blockers": [],
          "order_flow_stalled": true,
          "alternates": {
            "sell": {
              "direction": "sell",
              "entry": 1.17745,
              "entry_window": [
                1.177406430769231,
                1.1775371384615385
              ],
              "stop_loss": 1.1776678461538463,
              "take_profit_1": 1.1770143076923076,
              "take_profit_2": 1.1767964615384614,
              "risk": 0.00021784615384620772,
              "score": 62.0,
              "confidence": "medium",
              "trigger_levels": {
                "window_low": 1.177406430769231,
                "window_high": 1.1775371384615385,
                "fire": 1.17745,
                "arm": 1.177406430769231,
                "disarm": 1.1775371384615385
              },
              "order_flow_ready": false
            }
          },
          "ready_timeout_minutes": 15,
          "arming_timeout_minutes": 20,
          "context": {
            "intraday_profile": {
              "range_state": "expansion",
              "range_position": 0.6867469879516687,
              "range_vs_atr": 4.572033898304551
            }
          }
        },
        "precision_trigger": {
          "state": "fire",
          "ready_ts": "2025-12-30T02:59:00Z",
          "entry_window": [
            1.1773328615384615,
            1.1774635692307691
          ],
          "trigger_levels": {
            "window_low": 1.1773328615384615,
            "window_high": 1.1774635692307691,
            "fire": 1.17742,
            "arm": 1.1774635692307691,
            "disarm": 1.1773328615384615
          },
          "score": 62.0,
          "score_threshold": 55.0,
          "score_ready": true,
          "trigger_ready": true,
          "order_flow_ready": false,
          "order_flow_strength": null,
          "trigger_progress": 1.0,
          "trigger_confidence": 0.54,
          "reasons": [
            "price hit entry"
          ]
        },
        "action_plan": {
          "status": "standby",
          "priority": "low",
          "summary": "Nincs belépő – figyeld a következő megerősítést.",
          "steps": [
            {
              "order": 1,
              "category": "precision_trigger",
              "instruction": "Precision trigger: fire",
              "source": "execution_playbook",
              "entry_window": [
                1.1773328615384615,
                1.1774635692307691
              ],
              "trigger_levels": {
                "window_low": 1.1773328615384615,
                "window_high": 1.1774635692307691,
                "fire": 1.17742,
                "arm": 1.1774635692307691,
                "disarm": 1.1773328615384615
              }
            }
          ],
          "blockers": [],
          "blockers_raw": [],
          "notes": [
            "Range expanzió >1.5×ATR — agresszív menedzsment indokolt.",
            "Összesített valószínűség: 40%.",
            "Ajánlott tőkeáttétel: ×30.0.",
            "Célzott RR: 2.70R.",
            "Precision score: 62.00 / küszöb 55.",
            "Precision confidence: medium.",
            "Precision trigger állapot: fire.",
            "Bias(4H→1H)=long (+15.0)",
            "Regime filter inaktív",
            "5M BOS trendirányba (+16.0)",
            "ATR nincs rendben (relatív vagy abszolút küszöb)",
            "Alacsony realised vol → magasabb RR igény",
            "Range expanzió támogatja a momentumot (+3.0)"
          ],
          "context": {
            "asset": "EURUSD",
            "decision": "no entry",
            "probability": 40,
            "session_open": true,
            "session_entry_open": true,
            "session_status": "open",
            "intraday_profile": {
              "range_state": "expansion",
              "range_position": 0.6867469879516687,
              "range_vs_atr": 4.572033898304551,
              "range_guard": {
                "long": false,
                "short": false
              },
              "opening_break": "none"
            },
            "next_session_open_utc": "2025-12-31T00:00:00+00:00",
            "precision_trigger_state": "fire",
            "precision_direction": "buy"
          }
        },
        "execution_playbook": [
          {
            "step": "precision_trigger",
            "state": "fire",
            "description": "Precision trigger: fire",
            "entry_window": [
              1.1773328615384615,
              1.1774635692307691
            ],
            "trigger_levels": {
              "window_low": 1.1773328615384615,
              "window_high": 1.1774635692307691,
              "fire": 1.17742,
              "arm": 1.1774635692307691,
              "disarm": 1.1773328615384615
            },
            "ready_ts": "2025-12-30T02:59:00Z",
            "score": 62.0,
            "score_threshold": 55.0,
            "score_ready": true,
            "trigger_ready": true,
            "order_flow_ready": false,
            "order_flow_strength": null,
            "trigger_progress": 1.0,
            "trigger_confidence": 0.54,
            "reasons": [
              "price hit entry"
            ]
          }
        ]
      },
      "trade_levels": {
        "entry": 1.17742,
        "sl": 1.1656457999999998,
        "tp1": 1.19861356,
        "tp2": 1.20921034,
        "rr": 2.7
      },
      "position_state": {
        "tracking_enabled": true,
        "side": null,
        "has_position": false,
        "cooldown_active": false,
        "cooldown_until_utc": null,
        "opened_at_utc": null,
        "entry": null,
        "sl": null,
        "tp1": null,
        "tp2": null
      },
      "intent": "standby",
      "actionable": false,
      "notify": {
        "should_notify": false,
        "reason": "non_actionable",
        "cooldown_until_utc": null
      }
    },
    "GOLD_CFD": {
      "asset": "GOLD_CFD",
      "ok": false,
      "error": "cannot access local variable 'strong_momentum' where it is not associated with a value"
    },
    "NVDA": {
      "asset": "NVDA",
      "ok": false,
      "retrieved_at_utc": "2025-12-30T03:01:31Z",
      "source": "Twelve Data (lokális JSON)",
      "spot": {
        "price": null,
        "utc": "-",
        "retrieved_at_utc": "2025-12-30T03:00:50Z"
      },
      "signal": "market closed",
      "probability": 0,
      "probability_model": null,
      "probability_model_raw": null,
      "probability_calibrated": null,
      "probability_threshold": null,
      "probability_model_source": "sklearn",
      "probability_stack": {
        "source": "sklearn",
        "status": "data_gap",
        "unavailable_reason": "data_gap",
        "detail": "Piac zárva (nyitáson kívül); Critical data latency — belépés tiltva"
      },
      "entry": null,
      "sl": null,
      "tp1": null,
      "tp2": null,
      "rr": null,
      "leverage": 5.0,
      "gates": {
        "mode": "session_closed",
        "required": [
          "session"
        ],
        "missing": [
          "session"
        ]
      },
      "session_info": {
        "open": false,
        "entry_open": false,
        "within_window": false,
        "within_entry_window": false,
        "within_monitor_window": false,
        "weekday_ok": true,
        "now_utc": "2025-12-30T03:01:31.174663+00:00",
        "now_budapest": "2025-12-30T04:01:31.174663+01:00",
        "windows_utc": [
          [
            13,
            30,
            20,
            0
          ]
        ],
        "time_zone": "Europe/Berlin",
        "time_zone_budapest": "Europe/Budapest",
        "windows_local_cet": [
          [
            "14:30",
            "21:00"
          ]
        ],
        "windows_local_budapest": [
          [
            "14:30",
            "21:00"
          ]
        ],
        "allowed_weekdays": [
          0,
          1,
          2,
          3,
          4
        ],
        "status_profile": "default",
        "sunday_open_utc": "14:30",
        "sunday_open_budapest": "15:30",
        "next_session_open_utc": "2025-12-30T13:30:00+00:00",
        "next_session_open_budapest": "2025-12-30T14:30:00+01:00",
        "status": "closed_out_of_hours",
        "status_note": "Piac zárva (nyitáson kívül)",
        "market_closed_reason": "outside_hours",
        "notes": [
          "Alapértelmezett session profil — valós idejű nyitvatartási szabályok érvényesek"
        ],
        "next_open_utc": "2025-12-30T13:30:00+00:00"
      },
      "diagnostics": {
        "timeframes": {
          "k1m": {
            "last_raw_utc": null,
            "last_closed_utc": null,
            "latency_seconds": null,
            "expected_max_delay_seconds": 180,
            "source_mtime_utc": "2025-12-30T03:00:50Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 240.0,
            "freshness_violation": false,
            "freshness_retries": null,
            "used_symbol": null,
            "used_exchange": null,
            "retrieved_at_utc": "2025-12-30T03:00:50Z",
            "error": "market closed (outside_hours)",
            "critical_stale": false
          },
          "k5m": {
            "last_raw_utc": null,
            "last_closed_utc": null,
            "latency_seconds": null,
            "expected_max_delay_seconds": 300,
            "source_mtime_utc": "2025-12-30T03:00:50Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 900.0,
            "freshness_violation": false,
            "freshness_retries": null,
            "used_symbol": null,
            "used_exchange": null,
            "retrieved_at_utc": "2025-12-30T03:00:50Z",
            "error": "market closed (outside_hours)",
            "critical_stale": false
          },
          "k1h": {
            "last_raw_utc": null,
            "last_closed_utc": null,
            "latency_seconds": null,
            "expected_max_delay_seconds": 3600,
            "source_mtime_utc": "2025-12-30T03:00:50Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 5400.0,
            "freshness_violation": false,
            "freshness_retries": null,
            "used_symbol": null,
            "used_exchange": null,
            "retrieved_at_utc": "2025-12-30T03:00:50Z",
            "error": "market closed (outside_hours)",
            "critical_stale": false
          },
          "k4h": {
            "last_raw_utc": null,
            "last_closed_utc": null,
            "latency_seconds": null,
            "expected_max_delay_seconds": 14400,
            "source_mtime_utc": "2025-12-30T03:00:50Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 21600.0,
            "freshness_violation": false,
            "freshness_retries": null,
            "used_symbol": null,
            "used_exchange": null,
            "retrieved_at_utc": "2025-12-30T03:00:50Z",
            "error": "market closed (outside_hours)",
            "critical_stale": false
          },
          "spot": {
            "last_raw_utc": "2025-12-30T03:00:50Z",
            "latency_seconds": 41,
            "expected_max_delay_seconds": 600,
            "source_mtime_utc": "2025-12-30T03:00:50Z",
            "source": "quote",
            "fallback_used": false,
            "realtime_override": false,
            "freshness_limit_seconds": 600.0,
            "freshness_retries": null,
            "freshness_violation": false,
            "freshness_violation_meta": false,
            "used_symbol": "NVDA",
            "used_exchange": "NASDAQ",
            "original_issue": "Spot price missing"
          }
        },
        "source_files": {
          "spot.json": "2025-12-30T03:00:50Z",
          "klines_1m.json": "2025-12-30T03:00:50Z",
          "klines_5m.json": "2025-12-30T03:00:50Z",
          "klines_1h.json": "2025-12-30T03:00:50Z",
          "klines_4h.json": "2025-12-30T03:00:50Z"
        },
        "latency_flags": [],
        "refresh_tips": [
          "Az analysis.py mindig a legutóbbi ZÁRT gyertyával számol (5m: max. ~5 perc késés).",
          "CI/CD-ben kösd össze a Trading és Analysis futást: az analysis job csak a trading után induljon (needs: trading).",
          "A kliens kéréséhez adj cache-busting query paramot (pl. ?v=<timestamp>) és no-store cache-control fejlécet.",
          "Cloudflare Worker stale policy: 5m feedre állítsd 120s-re, hogy hamar átjöjjön az új jel.",
          "A dashboard stabilizáló (2 azonos jel + 10 perc cooldown) lassíthatja a kártya frissítését — lazítsd, ha realtime kell."
        ]
      },
      "reasons": [
        "Piac zárva (nyitáson kívül)",
        "Critical data latency — belépés tiltva"
      ]
    },
    "XAGUSD": {
      "asset": "XAGUSD",
      "ok": false,
      "error": "cannot access local variable 'strong_momentum' where it is not associated with a value"
    },
    "BTCUSD": {
      "asset": "BTCUSD",
      "ok": true,
      "retrieved_at_utc": "2025-12-30T03:01:31Z",
      "source": "Twelve Data (lokális JSON)",
      "spot": {
        "price": 86984.48,
        "utc": "2025-12-30T03:01:10Z",
        "retrieved_at_utc": "2025-12-30T03:01:10Z",
        "source": "twelvedata:quote",
        "realtime_override": false,
        "fallback_used": false,
        "confidence": 0.9999999999999998,
        "avg_latency_profile": 20.999999999999996,
        "realtime_stats": null
      },
      "signal": "precision_arming",
      "probability": 61,
      "probability_raw": 61,
      "entry": null,
      "sl": null,
      "tp1": null,
      "tp2": null,
      "rr": null,
      "leverage": 2.0,
      "position_size_scale": 0.1375,
      "range_time_stop": null,
      "funding_filter": null,
      "funding_rate": null,
      "stale_timeframes": {
        "k1m": false,
        "k5m": false,
        "k1h": false,
        "k4h": false
      },
      "biases": {
        "raw_4h": "short",
        "raw_1h": "short",
        "adjusted_4h": "short",
        "adjusted_1h": "short"
      },
      "gates": {
        "mode": "core",
        "required": [
          "session",
          "spread_guard",
          "data_integrity",
          "risk_reward",
          "structure(2of3)",
          "intraday_range_guard",
          "atr",
          "rr_math>=1.6",
          "tp_min_profit",
          "min_stoploss",
          "tp1_net>=+0.6%",
          "precision_score>=49",
          "precision_trigger_sync"
        ],
        "missing": [],
        "session_window_status": {
          "entry_open": true,
          "monitor_window": true,
          "status": "open",
          "status_note": "Piac nyitva",
          "összefoglaló": "Entry ablak NYITVA, Megfigyelés aktív"
        }
      },
      "gate_skips": [],
      "session_info": {
        "open": true,
        "entry_open": true,
        "within_window": true,
        "within_entry_window": true,
        "within_monitor_window": true,
        "weekday_ok": true,
        "now_utc": "2025-12-30T03:01:31.341794+00:00",
        "now_budapest": "2025-12-30T04:01:31.341794+01:00",
        "windows_utc": [
          [
            0,
            0,
            23,
            59
          ]
        ],
        "time_zone": "Europe/Berlin",
        "time_zone_budapest": "Europe/Budapest",
        "windows_local_cet": [
          [
            "01:00",
            "00:59"
          ]
        ],
        "windows_local_budapest": [
          [
            "01:00",
            "00:59"
          ]
        ],
        "allowed_weekdays": [
          0,
          1,
          2,
          3,
          4,
          5,
          6
        ],
        "status_profile": "default",
        "minutes_to_session_close": 1258,
        "session_close_reason": "entry_window",
        "next_session_open_utc": "2025-12-31T00:00:00+00:00",
        "next_session_open_budapest": "2025-12-31T01:00:00+01:00",
        "status": "open",
        "status_note": "Piac nyitva",
        "notes": [
          "Alapértelmezett session profil — valós idejű nyitvatartási szabályok érvényesek"
        ],
        "next_open_utc": "2025-12-31T00:00:00+00:00"
      },
      "momentum_diagnostics": {
        "evaluated": true,
        "used_for_decision": false,
        "direction_result": null,
        "required": [
          "session",
          "regime",
          "bias",
          "momentum_trigger",
          "structure(2of3)",
          "atr",
          "rr_math>=1.4",
          "tp_min_profit",
          "min_stoploss",
          "tp1_net>=+0.6%",
          "intraday_range_guard"
        ],
        "missing": [
          "regime",
          "ofi"
        ],
        "liquidity_data_available": false,
        "flow_data_available": false,
        "ofi_available": false,
        "momentum_trigger_ok": null,
        "momentum_atr_ok": true,
        "trigger_desc": null,
        "precision_data_gap_mode": false
      },
      "diagnostics": {
        "timeframes": {
          "k1m": {
            "last_raw_utc": "2025-12-30T02:59:00Z",
            "last_closed_utc": "2025-12-30T02:59:00Z",
            "latency_seconds": 151,
            "expected_max_delay_seconds": 180,
            "source_mtime_utc": "2025-12-30T03:01:18Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 240.0,
            "freshness_violation": false,
            "freshness_retries": 0,
            "used_symbol": "BTC/USD",
            "used_exchange": "Coinbase Pro",
            "retrieved_at_utc": "2025-12-30T03:01:18Z",
            "latency_guard_seconds": 138,
            "latency_guard_adjustment_seconds": 13,
            "critical_stale": false
          },
          "k5m": {
            "last_raw_utc": "2025-12-30T02:55:00Z",
            "last_closed_utc": "2025-12-30T02:55:00Z",
            "latency_seconds": 391,
            "expected_max_delay_seconds": 300,
            "source_mtime_utc": "2025-12-30T03:01:24Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 900.0,
            "freshness_violation": false,
            "freshness_retries": 0,
            "used_symbol": "BTC/USD",
            "used_exchange": "Coinbase Pro",
            "retrieved_at_utc": "2025-12-30T03:01:24Z",
            "latency_guard_seconds": 384,
            "latency_guard_adjustment_seconds": 7,
            "critical_stale": false
          },
          "k1h": {
            "last_raw_utc": "2025-12-30T02:00:00Z",
            "last_closed_utc": "2025-12-30T02:00:00Z",
            "latency_seconds": 3691,
            "expected_max_delay_seconds": 3600,
            "source_mtime_utc": "2025-12-30T03:01:15Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 5400.0,
            "freshness_violation": false,
            "freshness_retries": 0,
            "used_symbol": "BTC/USD",
            "used_exchange": "Coinbase Pro",
            "retrieved_at_utc": "2025-12-30T03:01:15Z",
            "latency_guard_seconds": 3675,
            "latency_guard_adjustment_seconds": 16,
            "critical_stale": false
          },
          "k4h": {
            "last_raw_utc": "2025-12-30T00:00:00Z",
            "last_closed_utc": "2025-12-30T00:00:00Z",
            "latency_seconds": 10891,
            "expected_max_delay_seconds": 14400,
            "source_mtime_utc": "2025-12-30T03:01:14Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 21600.0,
            "freshness_violation": false,
            "freshness_retries": 0,
            "used_symbol": "BTC/USD",
            "used_exchange": "Coinbase Pro",
            "retrieved_at_utc": "2025-12-30T03:01:14Z",
            "latency_guard_seconds": 10874,
            "latency_guard_adjustment_seconds": 17,
            "critical_stale": false
          },
          "spot": {
            "last_raw_utc": "2025-12-30T03:01:10Z",
            "latency_seconds": 21,
            "expected_max_delay_seconds": 300,
            "source_mtime_utc": "2025-12-30T03:01:24Z",
            "source": "twelvedata:quote",
            "fallback_used": false,
            "realtime_override": false,
            "freshness_limit_seconds": 300.0,
            "freshness_retries": 0,
            "freshness_violation": false,
            "freshness_violation_meta": false,
            "used_symbol": "BTC/USD",
            "used_exchange": "Coinbase Pro"
          }
        },
        "source_files": {
          "spot.json": "2025-12-30T03:01:24Z",
          "klines_1m.json": "2025-12-30T03:01:18Z",
          "klines_5m.json": "2025-12-30T03:01:24Z",
          "klines_1h.json": "2025-12-30T03:01:15Z",
          "klines_4h.json": "2025-12-30T03:01:14Z"
        },
        "latency_flags": [],
        "refresh_tips": [
          "Az analysis.py mindig a legutóbbi ZÁRT gyertyával számol (5m: max. ~5 perc késés).",
          "CI/CD-ben kösd össze a Trading és Analysis futást: az analysis job csak a trading után induljon (needs: trading).",
          "A kliens kéréséhez adj cache-busting query paramot (pl. ?v=<timestamp>) és no-store cache-control fejlécet.",
          "Cloudflare Worker stale policy: 5m feedre állítsd 120s-re, hogy hamar átjöjjön az új jel.",
          "A dashboard stabilizáló (2 azonos jel + 10 perc cooldown) lassíthatja a kártya frissítését — lazítsd, ha realtime kell."
        ]
      },
      "reasons": [
        "Bias(4H→1H)=short (+15.0)",
        "Regime filter inaktív",
        "5M BOS trendirányba (+16.0)",
        "ATR erősség 1.23× küszöb (+12.4)",
        "Alacsony realised vol → magasabb RR igény",
        "Range expanzió támogatja a momentumot (+3.0)",
        "ema9x21+ofi_z=-999.00",
        "Fib zóna konfluencia (0.618–0.886) (+18.0)",
        "P-Score reduced by 4.0 due to regime CHOPPY",
        "BTC momentum override — pozícióméret csökkentve",
        "Regime kapu: CHOPPY miatt −10 P-score, pozícióskálázás csökkentve",
        "Strukturális kapu lazítva: momentum erős, BOS hiány engedve",
        "Order-flow gates skipped (no tick/imbalance data)",
        "Precision trigger kész → limit figyelés",
        "Precision limit belépő parkolva 16 percig"
      ],
      "realtime_transport": "http",
      "data_integrity_diagnostics": {
        "core_data_ok": true,
        "precision_data_ok": true,
        "precision_disabled_due_to_data_gap": false,
        "core_required_sources": [
          "spot",
          "k5m"
        ],
        "precision_required_sources": [
          "spot",
          "k5m",
          "k1m"
        ],
        "spot": {
          "last_raw_utc": "2025-12-30T03:01:10Z",
          "latency_seconds": 21,
          "expected_max_delay_seconds": 300,
          "source_mtime_utc": "2025-12-30T03:01:24Z",
          "source": "twelvedata:quote",
          "fallback_used": false,
          "realtime_override": false,
          "freshness_limit_seconds": 300.0,
          "freshness_retries": 0,
          "freshness_violation": false,
          "freshness_violation_meta": false,
          "used_symbol": "BTC/USD",
          "used_exchange": "Coinbase Pro"
        },
        "k5m": {
          "last_raw_utc": "2025-12-30T02:55:00Z",
          "last_closed_utc": "2025-12-30T02:55:00Z",
          "latency_seconds": 391,
          "expected_max_delay_seconds": 300,
          "source_mtime_utc": "2025-12-30T03:01:24Z",
          "stale_for_signals": false,
          "freshness_limit_seconds": 900.0,
          "freshness_violation": false,
          "freshness_retries": 0,
          "used_symbol": "BTC/USD",
          "used_exchange": "Coinbase Pro",
          "retrieved_at_utc": "2025-12-30T03:01:24Z",
          "latency_guard_seconds": 384,
          "latency_guard_adjustment_seconds": 7,
          "critical_stale": false
        },
        "k1m": {
          "last_raw_utc": "2025-12-30T02:59:00Z",
          "last_closed_utc": "2025-12-30T02:59:00Z",
          "latency_seconds": 151,
          "expected_max_delay_seconds": 180,
          "source_mtime_utc": "2025-12-30T03:01:18Z",
          "stale_for_signals": false,
          "freshness_limit_seconds": 240.0,
          "freshness_violation": false,
          "freshness_retries": 0,
          "used_symbol": "BTC/USD",
          "used_exchange": "Coinbase Pro",
          "retrieved_at_utc": "2025-12-30T03:01:18Z",
          "latency_guard_seconds": 138,
          "latency_guard_adjustment_seconds": 13,
          "critical_stale": false
        }
      },
      "profile_resolution": {
        "asset": "BTCUSD",
        "entry_profile": "intraday",
        "global_default_profile": null,
        "schedule_enabled": true,
        "schedule_bucket": "mid",
        "schedule_selected_profile": "intraday",
        "resolution_notes": [
          "profile via schedule bucket mid -> intraday"
        ]
      },
      "effective_thresholds": {
        "asset": "BTCUSD",
        "entry_profile": "intraday",
        "p_score_min": 34.0,
        "spread_max_atr_pct": 0.8,
        "tp_net_min": 0.006,
        "rr_required": 1.55,
        "tp_min_profit_pct": 0.0062,
        "min_stoploss_pct": 0.01,
        "atr_abs_min_used": 50.0,
        "atr_low_threshold": 0.0011340129237642762,
        "atr_overlay_min": null,
        "bos_lookback": 50,
        "fib_tolerance": 0.017,
        "position_scale_floor": 0.04,
        "staleness_max_age_seconds": 300,
        "session_window": {
          "entry": [
            [
              0,
              0,
              23,
              59
            ]
          ],
          "monitor": [
            [
              0,
              0,
              23,
              59
            ]
          ]
        }
      },
      "probability_model_source": "sklearn",
      "probability_model": null,
      "probability_model_raw": null,
      "probability_calibrated": null,
      "probability_threshold": null,
      "probability_stack": {
        "source": "sklearn",
        "status": "disabled",
        "unavailable_reason": "ml_scoring_disabled"
      },
      "ema21_slope_1h": -0.007278267503799847,
      "ema21_slope_threshold": 0.015,
      "ema21_relation_1h": "below",
      "last_swing_high_1h": 87241.99,
      "last_swing_low_1h": 86955.76,
      "last_close_1h": 86984.48,
      "bos_5m_dir": "bos_down",
      "atr1h": 446.2578571428572,
      "momentum_volume_ratio": null,
      "momentum_liquidity_ok": true,
      "dynamic_tp_profile": {
        "core": {
          "tp1": 2.0,
          "tp2": 3.0,
          "rr": 1.55
        },
        "momentum": {
          "tp1": 1.5,
          "tp2": 2.4,
          "rr": 1.4
        },
        "regime": "normal",
        "reference": {
          "current": 121.36214285714232,
          "q20": 98.2802857142869,
          "q50": 125.4742857142888,
          "q80": 180.43028571428462
        }
      },
      "order_flow_metrics": {
        "imbalance": null,
        "pressure": 0.0,
        "delta_volume": 0.0,
        "aggressor_ratio": null,
        "imbalance_z": null,
        "status": "ok"
      },
      "intraday_profile": {
        "asset": "BTCUSD",
        "timestamp": "2025-12-30T03:01:31Z",
        "day_start_utc": "2025-12-29T23:00:00Z",
        "day_open": 87227.79,
        "day_high": 87291.09,
        "day_low": 86855.47,
        "day_range": 435.61999999999534,
        "range_vs_atr": 3.5894224487513533,
        "range_position": 0.29615261007299054,
        "range_bias": "lower",
        "range_state": "expansion",
        "range_compression": false,
        "range_expansion": true,
        "range_exhaustion_long": false,
        "range_exhaustion_short": false,
        "range_guard": {
          "long": false,
          "short": false
        },
        "micro_range_position": 0.3521784232365075,
        "micro_range_vs_atr": 3.0184041858192523,
        "micro_range_guard": {
          "long": false,
          "short": false
        },
        "opening_range_high": 87291.09,
        "opening_range_low": 87061.16,
        "opening_break": "down",
        "opening_range_minutes": 45,
        "opening_drive_ratio": 0.5278224140305667,
        "previous_close": 87227.79,
        "opening_gap": 0.0,
        "opening_gap_pct": 0.0,
        "opening_gap_direction": "flat",
        "price_reference": 86984.48,
        "elapsed_minutes": 241,
        "notes": [
          "Range expanzió >1.5×ATR — agresszív menedzsment indokolt.",
          "Opening range áttörés iránya: down."
        ]
      },
      "entry_thresholds": {
        "profile": "intraday",
        "btc_profile": "intraday",
        "news_lockout": false,
        "btc_ofi_thresholds": {
          "trigger": 0.8,
          "strong": 1.0,
          "weakening": -0.4
        },
        "adx_value": 37.99443960394879,
        "adx_trend_threshold": 20.0,
        "adx_regime_initial": "balanced",
        "btc_rr_adx": {
          "profile": "intraday",
          "rr_min": 1.5,
          "mode": "trend"
        },
        "btc_atr_floor_usd": 75.0,
        "btc_atr_floor_ratio": 0.0008622227781323749,
        "btc_atr_floor_passed": true,
        "btc_atr_ratio_threshold": 0.0012,
        "btc_atr_gate_threshold_usd": 75.0,
        "btc_atr_value_usd": 121.36214285714232,
        "btc_atr_gate_ok": true,
        "atr_multiplier": 0.0,
        "atr_threshold_base": 0.0008622227781323749,
        "atr_threshold_initial": 0.0008622227781323749,
        "atr_intraday_relax": 0.8,
        "atr_threshold_intraday": 0.0006897782225058999,
        "atr_percentile_meta": {
          "bucket": "open",
          "samples": 95,
          "profile": "intraday",
          "percentile": 0.34,
          "threshold": 0.0011340129237642762
        },
        "atr_threshold_percentile": 0.0011340129237642762,
        "spread_ratio": null,
        "atr_soft_gate": {
          "enabled": true,
          "rel_atr": 0.0013952160529917788,
          "threshold": 0.0011340129237642762,
          "tolerance_pct": 0.15,
          "penalty_max": 6.0,
          "diff_ratio": -0.23033523141910692,
          "mode": "pass"
        },
        "atr_ratio_ok": true,
        "atr_threshold_effective": 0.0011340129237642762,
        "spread_gate_ok": true,
        "atr_abs_min_used": 50.0,
        "atr_abs_override_applied": false,
        "risk_guard": {
          "profile": "intraday",
          "max_risk_pct": 1.6,
          "spread_gate_ok": true,
          "allowed": true,
          "cost_model": {
            "type": "pct",
            "round_trip_pct": 0.01,
            "overnight_pct": 0.0
          }
        },
        "fib_tolerance_fraction": 0.017,
        "btc_atr_ratio": 1.230335231419107,
        "btc_volume_ratio": 0.0,
        "btc_range_expansion": true,
        "btc_momentum_cross": true,
        "btc_momentum_ofi_ok": false,
        "btc_momentum_atr_ok": true,
        "dynamic_score_engine": {
          "base_score": 75.38201138851464,
          "regime_penalty": {
            "label": "CHOPPY",
            "points": -4.0
          },
          "final_score": 71.38201138851464
        },
        "ofi_z": null,
        "vwap_confluence": {
          "trend_pullback": false,
          "mean_revert": false
        },
        "btc_core_triggers": {
          "bos_ok": false,
          "vwap_ok": false,
          "ofi_ok": false,
          "ofi_z": null,
          "available": [
            "bos",
            "vwap"
          ],
          "missing": [
            "ofi"
          ],
          "required_hits": 2,
          "hits": 0
        },
        "btc_structure_combo": {
          "active_direction": "short",
          "active": {
            "micro": false,
            "vwap": false,
            "ofi": false,
            "count": 0
          },
          "combos": {
            "long": {
              "micro": false,
              "vwap": false,
              "ofi": false,
              "price_above_vwap": false,
              "price_below_vwap": false
            },
            "short": {
              "micro": false,
              "vwap": false,
              "ofi": false,
              "price_above_vwap": false,
              "price_below_vwap": false
            }
          },
          "either_of_ok": false
        },
        "structure_components": {
          "bos": false,
          "liquidity": false,
          "ofi": false
        },
        "btc_momentum_override": true,
        "p_score_min_profile_override": {
          "profile": "intraday",
          "value": 34.0
        },
        "p_score_min_base": 34.0,
        "bias_meta": "short",
        "bias_micro": null,
        "p_score_min_effective": 34.0,
        "adx_regime": "trend",
        "btc_position_scale": 0.55,
        "btc_position_meta": {
          "profile_cap": 0.6,
          "profile": "intraday",
          "momentum_override_cap": 0.55
        },
        "position_size_scale": 0.55,
        "rr_min_core": 1.55,
        "rr_min_momentum": 1.4,
        "rr_meta": {
          "core_rr_min_base": 1.55,
          "momentum_rr_min_base": 1.4,
          "core_rr_min": 1.55,
          "momentum_rr_min": 1.4
        },
        "precision_gate_state": {
          "score_ready": true,
          "score": 62.0,
          "threshold": 49.0,
          "flow_ready": true,
          "trigger_ready": true,
          "trigger_state": "fire",
          "flow_blockers": [],
          "profile": "intraday",
          "position_sizing_floor": 0.01,
          "precision_state": "precision_arming",
          "precision_soft_block": false,
          "precision_profile": "intraday",
          "btc_precision_threshold": 49.0,
          "precision_ready_since": null,
          "precision_arming_since": null,
          "precision_events": 1,
          "precision_hits_ready": 0,
          "precision_hits_arming": 1,
          "precision_hits_soft_block": 0
        },
        "precision_score_threshold": 49.0,
        "precision_timeouts": {
          "ready": 12,
          "arming": 16
        },
        "btc_level_checks": {
          "core": {
            "profile": "intraday",
            "mode": "core",
            "side": "sell",
            "entry": 86984.48,
            "sl": 87854.3248,
            "tp1": 85244.79039999998,
            "tp2": 84374.94559999998,
            "risk_abs": 869.8448000000062,
            "tp1_mult": 2.0,
            "tp2_mult": 3.0,
            "rr_required": 1.55,
            "sl_buffer": 869.8448000000062,
            "sl_buffer_min": 80.0,
            "sl_buffer_abs_min": 80.0,
            "btc_profile": "intraday",
            "spread_usd": 0.0,
            "spread_limit_atr_mult": 0.9,
            "tp_pct": 0.020000000000000143,
            "tp_min_pct": 0.0062,
            "rr": 2.0,
            "rr_min": 1.55,
            "tp1_distance": 1739.6896000000124,
            "sl_distance": 869.8448000000062,
            "rr_tp2": 3.0,
            "blockers": []
          }
        }
      },
      "entry_gate_context_hu": {
        "atr_kapu": {
          "ok": true,
          "rel_atr": 0.0013952160529917788,
          "threshold": 0.0011340129237642762,
          "abs_ok": true,
          "overlay_ok": true,
          "btc_atr_gate": true,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "spread_kapu": {
          "ok": true,
          "spread_ratio_atr": null,
          "spread_limit_atr": 0.8,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "kockazat_guard": {
          "max_risk_pct": 1.6,
          "engedi": true,
          "cost_model": {
            "type": "pct",
            "round_trip_pct": 0.01,
            "overnight_pct": 0.0
          },
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "profil_kuszobok": {
          "profil": "intraday",
          "p_score_min": 30.0,
          "p_score_min_base": 30.0,
          "atr_kuszob_rel": 0.0011340129237642762,
          "atr_abs_min": 50.0,
          "fib_tures_frac": 0.017,
          "fib_tures_atr": 334.6933928571429,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "bos_visszatekintes": 50,
        "fib_zona": {
          "ok": true,
          "sav": [
            0.618,
            0.886
          ],
          "tures_frac": 0.017,
          "tures_atr": 334.6933928571429,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "session_ablak_utc": {
          "entry": [
            [
              0,
              0,
              23,
              59
            ]
          ],
          "monitor": [
            [
              0,
              0,
              23,
              59
            ]
          ]
        },
        "p_score_profil": "intraday",
        "structure_kapu": {
          "ok": false,
          "komponensek": {
            "bos": false,
            "liquidity": false,
            "ofi": false
          },
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "rr_kapuk": {
          "core_rr_min": 1.55,
          "momentum_rr_min": 1.4,
          "relaxalt": false,
          "indok": null,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "momentum_kapu": {
          "momentum_ok": false,
          "momentum_direction": null,
          "momentum_reason": "missing:ofi,regime",
          "momentum_missing": [
            "regime",
            "ofi"
          ],
          "momentum_regime_ok": false,
          "momentum_structure_ok": false,
          "momentum_atr_ok": true,
          "momentum_liquidity_ok": true,
          "momentum_trigger_ok": false,
          "momentum_ofi_z": null,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "precision_kapu": {
          "score_ready": true,
          "score": 62.0,
          "threshold": 49.0,
          "flow_ready": true,
          "trigger_ready": true,
          "trigger_state": "fire",
          "flow_blockers": [],
          "profile": "intraday",
          "position_sizing_floor": 0.01,
          "precision_state": "precision_arming",
          "precision_soft_block": false,
          "precision_profile": "intraday",
          "btc_precision_threshold": 49.0,
          "precision_ready_since": null,
          "precision_arming_since": null,
          "precision_events": 1,
          "precision_hits_ready": 0,
          "precision_hits_arming": 1,
          "precision_hits_soft_block": 0,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        }
      },
      "volatility_overlay": {
        "implied_vol": null,
        "realised_vol": 0.0003652726924815421,
        "realised_window_minutes": 120,
        "regime": "suppressed",
        "premium": null,
        "source_path": null,
        "implied_realised_ratio": null
      },
      "precision_plan": {
        "asset": "BTCUSD",
        "direction": "sell",
        "score": 62.0,
        "confidence": "medium",
        "entry": 86984.48,
        "entry_window": [
          86955.35308571428,
          87042.73382857142
        ],
        "stop_loss": 87130.11457142857,
        "take_profit_1": 86693.21085714285,
        "take_profit_2": 86547.57628571428,
        "risk": 145.63457142857078,
        "liquidity_levels": [
          86979.91,
          86946.0,
          86940.36,
          86983.15,
          86983.15
        ],
        "factors": [
          "ATR1m 39.7786",
          "ATR5m 121.3621",
          "price near liquidity pocket"
        ],
        "score_threshold": 49.0,
        "score_ready": true,
        "trigger_state": "fire",
        "trigger_ready": true,
        "trigger_levels": {
          "window_low": 86955.35308571428,
          "window_high": 87042.73382857142,
          "fire": 86984.48,
          "arm": 86955.35308571428,
          "disarm": 87042.73382857142
        },
        "ready_ts": "2025-12-30T02:58:00Z",
        "order_flow_ready": true,
        "order_flow_strength": null,
        "microstructure_score": 62.0,
        "trigger_progress": 1.0,
        "trigger_confidence": 0.54,
        "trigger_reasons": [
          "price hit entry",
          "order flow stalled override"
        ],
        "order_flow_status": "ok",
        "order_flow_optional": false,
        "order_flow_settings": {
          "imbalance_threshold": 0.6,
          "pressure_threshold": 0.7,
          "imbalance_margin": 1.1,
          "pressure_margin": 1.1,
          "min_signals": 1,
          "strength_floor": 0.74,
          "block_ratio": 0.0
        },
        "order_flow_signals": 0,
        "order_flow_blockers": [],
        "order_flow_stalled": true,
        "order_flow_fallback": "stalled_flow_trigger_fire",
        "alternates": {
          "buy": {
            "direction": "buy",
            "entry": 86965.2,
            "entry_window": [
              86906.94617142857,
              86994.32691428572
            ],
            "stop_loss": 86819.56542857143,
            "take_profit_1": 87256.46914285714,
            "take_profit_2": 87402.10371428571,
            "risk": 145.63457142857078,
            "score": 62.0,
            "confidence": "medium",
            "trigger_levels": {
              "window_low": 86906.94617142857,
              "window_high": 86994.32691428572,
              "fire": 86965.2,
              "arm": 86994.32691428572,
              "disarm": 86906.94617142857
            },
            "order_flow_ready": false
          }
        },
        "ready_timeout_minutes": 12,
        "arming_timeout_minutes": 16,
        "context": {
          "intraday_profile": {
            "range_state": "expansion",
            "range_position": 0.29615261007299054,
            "range_vs_atr": 3.5894224487513533
          }
        }
      },
      "execution_playbook": [
        {
          "step": "precision_limit",
          "description": "Precision parkolt limit belépő 86955.35309–87042.73383 — 16 perc timeout",
          "direction": "sell",
          "confidence": "medium",
          "entry_window": [
            86955.35308571428,
            87042.73382857142
          ],
          "timeout_minutes": 16
        },
        {
          "step": "precision_trigger",
          "state": "fire",
          "description": "Precision trigger: fire",
          "entry_window": [
            86955.35308571428,
            87042.73382857142
          ],
          "trigger_levels": {
            "window_low": 86955.35308571428,
            "window_high": 87042.73382857142,
            "fire": 86984.48,
            "arm": 86955.35308571428,
            "disarm": 87042.73382857142
          },
          "ready_ts": "2025-12-30T02:58:00Z",
          "score": 62.0,
          "score_threshold": 49.0,
          "score_ready": true,
          "trigger_ready": true,
          "order_flow_ready": true,
          "order_flow_strength": null,
          "trigger_progress": 1.0,
          "trigger_confidence": 0.54,
          "reasons": [
            "price hit entry",
            "order flow stalled override"
          ]
        }
      ],
      "invalid_levels": {
        "buy": 86732.63107142856,
        "sell": 87465.11892857144
      },
      "invalid_buffer_abs": 223.1289285714286,
      "action_plan": {
        "status": "monitor_trigger",
        "priority": "high",
        "summary": "Precision trigger aktív",
        "steps": [
          {
            "order": 1,
            "category": "precision_limit",
            "instruction": "Precision parkolt limit belépő 86955.35309–87042.73383 — 16 perc timeout",
            "source": "execution_playbook",
            "confidence": "medium",
            "entry_window": [
              86955.35308571428,
              87042.73382857142
            ]
          },
          {
            "order": 2,
            "category": "precision_trigger",
            "instruction": "Precision trigger: fire",
            "source": "execution_playbook",
            "entry_window": [
              86955.35308571428,
              87042.73382857142
            ],
            "trigger_levels": {
              "window_low": 86955.35308571428,
              "window_high": 87042.73382857142,
              "fire": 86984.48,
              "arm": 86955.35308571428,
              "disarm": 87042.73382857142
            }
          },
          {
            "order": 3,
            "category": "precision_window",
            "instruction": "Figyeld a short belépő zónát 86955.4–87042.7.",
            "source": "precision",
            "entry_window": [
              86955.35308571428,
              87042.73382857142
            ]
          },
          {
            "order": 4,
            "category": "precision_stop",
            "instruction": "Precision SL előkészítése: 87130.1.",
            "source": "precision",
            "stop_loss": 87130.11457142857
          },
          {
            "order": 5,
            "category": "precision_trigger",
            "instruction": "Aktiváld az árriasztást a precision trigger szintekre.",
            "source": "precision",
            "trigger_levels": {
              "window_low": 86955.35308571428,
              "window_high": 87042.73382857142,
              "fire": 86984.48,
              "arm": 86955.35308571428,
              "disarm": 87042.73382857142
            }
          }
        ],
        "blockers": [
          "BTC trigger feltételek hiányosak."
        ],
        "blockers_raw": [
          "triggers"
        ],
        "notes": [
          "Belépési döntés – összefogás: mód: nincs; ATR kapu: OK; core trigger: hiányzik; momentum override: inaktív; RR min: 1.50",
          "Range expanzió >1.5×ATR — agresszív menedzsment indokolt.",
          "Opening range áttörés iránya: down.",
          "Összesített valószínűség: 61%.",
          "Ajánlott tőkeáttétel: ×2.0.",
          "Precision score: 62.00 / küszöb 49.",
          "Precision confidence: medium.",
          "Precision trigger állapot: fire.",
          "Bias(4H→1H)=short (+15.0)",
          "Regime filter inaktív",
          "5M BOS trendirányba (+16.0)",
          "ATR erősség 1.23× küszöb (+12.4)",
          "Alacsony realised vol → magasabb RR igény",
          "Range expanzió támogatja a momentumot (+3.0)"
        ],
        "context": {
          "asset": "BTCUSD",
          "decision": "precision_arming",
          "probability": 61,
          "session_open": true,
          "session_entry_open": true,
          "session_status": "open",
          "intraday_profile": {
            "range_state": "expansion",
            "range_position": 0.29615261007299054,
            "range_vs_atr": 3.5894224487513533,
            "range_guard": {
              "long": false,
              "short": false
            },
            "opening_break": "down"
          },
          "next_session_open_utc": "2025-12-31T00:00:00+00:00",
          "precision_state": "precision_arming",
          "precision_trigger_state": "fire",
          "precision_direction": "sell",
          "btc_entry_summary": {
            "profile": "intraday",
            "enter_mode": null,
            "atr_gate": {
              "ok": true,
              "value": 121.36214285714232,
              "threshold": 75.0
            },
            "core_triggers": {
              "ok": false
            },
            "momentum_override": {
              "ok": false,
              "rr_min": null,
              "note": null
            },
            "rr_min_effective": 1.5,
            "rr_from_adx": 1.5,
            "rr_info": {
              "mode": "trend"
            },
            "blockers": [
              "triggers"
            ]
          }
        }
      },
      "entry_diagnostics": {
        "required": [
          "session",
          "spread_guard",
          "data_integrity",
          "risk_reward",
          "structure(2of3)",
          "intraday_range_guard",
          "atr",
          "rr_math>=1.6",
          "tp_min_profit",
          "min_stoploss",
          "tp1_net>=+0.6%",
          "precision_score>=49",
          "precision_trigger_sync"
        ],
        "missing": [],
        "blockers": [
          "BTC trigger feltételek hiányosak."
        ],
        "p_score_used": 61
      },
      "position_diagnostics": {
        "state": null,
        "severity": null,
        "reasons": [],
        "p_score_used": 61
      },
      "active_position_meta": {
        "ema21_slope_abs": 0.007278267503799847,
        "ema21_slope_signed": -0.007278267503799847,
        "ema21_slope_threshold": 0.015,
        "ema21_relation": "below",
        "structure_5m": "bos_down",
        "stale_timeframes": {
          "k1m": false,
          "k5m": false,
          "k1h": false,
          "k4h": false
        },
        "atr1h": 446.2578571428572,
        "atr1h_trail_floor": 223.1289285714286,
        "atr5": 121.36214285714232,
        "atr5_rel": 0.0013952160529917788,
        "atr5_threshold": 0.0011340129237642762,
        "bos1h_long": false,
        "bos1h_short": true,
        "regime_ok": false,
        "effective_bias": "short",
        "last_close_1h": 86984.48,
        "last_swing_high_1h": 87241.99,
        "last_swing_low_1h": 86955.76,
        "invalid_level_sell": 87465.11892857144,
        "invalid_level_buy": 86732.63107142856,
        "invalid_buffer_abs": 223.1289285714286,
        "p_score": 61,
        "probability_calibrated": null,
        "probability_threshold": null,
        "probability_model_raw": null,
        "probability_model_source": "sklearn",
        "tp_profile": {
          "tp1_r": 2.0,
          "tp2_r": 3.0
        },
        "realtime_confidence": 0.9999999999999998,
        "avg_latency_profile": 20.999999999999996,
        "precision_plan": {
          "asset": "BTCUSD",
          "direction": "sell",
          "score": 62.0,
          "confidence": "medium",
          "entry": 86984.48,
          "entry_window": [
            86955.35308571428,
            87042.73382857142
          ],
          "stop_loss": 87130.11457142857,
          "take_profit_1": 86693.21085714285,
          "take_profit_2": 86547.57628571428,
          "risk": 145.63457142857078,
          "liquidity_levels": [
            86979.91,
            86946.0,
            86940.36,
            86983.15,
            86983.15
          ],
          "factors": [
            "ATR1m 39.7786",
            "ATR5m 121.3621",
            "price near liquidity pocket"
          ],
          "score_threshold": 49.0,
          "score_ready": true,
          "trigger_state": "fire",
          "trigger_ready": true,
          "trigger_levels": {
            "window_low": 86955.35308571428,
            "window_high": 87042.73382857142,
            "fire": 86984.48,
            "arm": 86955.35308571428,
            "disarm": 87042.73382857142
          },
          "ready_ts": "2025-12-30T02:58:00Z",
          "order_flow_ready": true,
          "order_flow_strength": null,
          "microstructure_score": 62.0,
          "trigger_progress": 1.0,
          "trigger_confidence": 0.54,
          "trigger_reasons": [
            "price hit entry",
            "order flow stalled override"
          ],
          "order_flow_status": "ok",
          "order_flow_optional": false,
          "order_flow_settings": {
            "imbalance_threshold": 0.6,
            "pressure_threshold": 0.7,
            "imbalance_margin": 1.1,
            "pressure_margin": 1.1,
            "min_signals": 1,
            "strength_floor": 0.74,
            "block_ratio": 0.0
          },
          "order_flow_signals": 0,
          "order_flow_blockers": [],
          "order_flow_stalled": true,
          "order_flow_fallback": "stalled_flow_trigger_fire",
          "alternates": {
            "buy": {
              "direction": "buy",
              "entry": 86965.2,
              "entry_window": [
                86906.94617142857,
                86994.32691428572
              ],
              "stop_loss": 86819.56542857143,
              "take_profit_1": 87256.46914285714,
              "take_profit_2": 87402.10371428571,
              "risk": 145.63457142857078,
              "score": 62.0,
              "confidence": "medium",
              "trigger_levels": {
                "window_low": 86906.94617142857,
                "window_high": 86994.32691428572,
                "fire": 86965.2,
                "arm": 86994.32691428572,
                "disarm": 86906.94617142857
              },
              "order_flow_ready": false
            }
          },
          "ready_timeout_minutes": 12,
          "arming_timeout_minutes": 16,
          "context": {
            "intraday_profile": {
              "range_state": "expansion",
              "range_position": 0.29615261007299054,
              "range_vs_atr": 3.5894224487513533
            }
          }
        },
        "precision_trigger": {
          "state": "fire",
          "ready_ts": "2025-12-30T02:58:00Z",
          "entry_window": [
            86955.35308571428,
            87042.73382857142
          ],
          "trigger_levels": {
            "window_low": 86955.35308571428,
            "window_high": 87042.73382857142,
            "fire": 86984.48,
            "arm": 86955.35308571428,
            "disarm": 87042.73382857142
          },
          "score": 62.0,
          "score_threshold": 49.0,
          "score_ready": true,
          "trigger_ready": true,
          "order_flow_ready": true,
          "order_flow_strength": null,
          "trigger_progress": 1.0,
          "trigger_confidence": 0.54,
          "reasons": [
            "price hit entry",
            "order flow stalled override"
          ]
        },
        "action_plan": {
          "status": "monitor_trigger",
          "priority": "high",
          "summary": "Precision trigger aktív",
          "steps": [
            {
              "order": 1,
              "category": "precision_limit",
              "instruction": "Precision parkolt limit belépő 86955.35309–87042.73383 — 16 perc timeout",
              "source": "execution_playbook",
              "confidence": "medium",
              "entry_window": [
                86955.35308571428,
                87042.73382857142
              ]
            },
            {
              "order": 2,
              "category": "precision_trigger",
              "instruction": "Precision trigger: fire",
              "source": "execution_playbook",
              "entry_window": [
                86955.35308571428,
                87042.73382857142
              ],
              "trigger_levels": {
                "window_low": 86955.35308571428,
                "window_high": 87042.73382857142,
                "fire": 86984.48,
                "arm": 86955.35308571428,
                "disarm": 87042.73382857142
              }
            },
            {
              "order": 3,
              "category": "precision_window",
              "instruction": "Figyeld a short belépő zónát 86955.4–87042.7.",
              "source": "precision",
              "entry_window": [
                86955.35308571428,
                87042.73382857142
              ]
            },
            {
              "order": 4,
              "category": "precision_stop",
              "instruction": "Precision SL előkészítése: 87130.1.",
              "source": "precision",
              "stop_loss": 87130.11457142857
            },
            {
              "order": 5,
              "category": "precision_trigger",
              "instruction": "Aktiváld az árriasztást a precision trigger szintekre.",
              "source": "precision",
              "trigger_levels": {
                "window_low": 86955.35308571428,
                "window_high": 87042.73382857142,
                "fire": 86984.48,
                "arm": 86955.35308571428,
                "disarm": 87042.73382857142
              }
            }
          ],
          "blockers": [
            "BTC trigger feltételek hiányosak."
          ],
          "blockers_raw": [
            "triggers"
          ],
          "notes": [
            "Belépési döntés – összefogás: mód: nincs; ATR kapu: OK; core trigger: hiányzik; momentum override: inaktív; RR min: 1.50",
            "Range expanzió >1.5×ATR — agresszív menedzsment indokolt.",
            "Opening range áttörés iránya: down.",
            "Összesített valószínűség: 61%.",
            "Ajánlott tőkeáttétel: ×2.0.",
            "Precision score: 62.00 / küszöb 49.",
            "Precision confidence: medium.",
            "Precision trigger állapot: fire.",
            "Bias(4H→1H)=short (+15.0)",
            "Regime filter inaktív",
            "5M BOS trendirányba (+16.0)",
            "ATR erősség 1.23× küszöb (+12.4)",
            "Alacsony realised vol → magasabb RR igény",
            "Range expanzió támogatja a momentumot (+3.0)"
          ],
          "context": {
            "asset": "BTCUSD",
            "decision": "precision_arming",
            "probability": 61,
            "session_open": true,
            "session_entry_open": true,
            "session_status": "open",
            "intraday_profile": {
              "range_state": "expansion",
              "range_position": 0.29615261007299054,
              "range_vs_atr": 3.5894224487513533,
              "range_guard": {
                "long": false,
                "short": false
              },
              "opening_break": "down"
            },
            "next_session_open_utc": "2025-12-31T00:00:00+00:00",
            "precision_state": "precision_arming",
            "precision_trigger_state": "fire",
            "precision_direction": "sell",
            "btc_entry_summary": {
              "profile": "intraday",
              "enter_mode": null,
              "atr_gate": {
                "ok": true,
                "value": 121.36214285714232,
                "threshold": 75.0
              },
              "core_triggers": {
                "ok": false
              },
              "momentum_override": {
                "ok": false,
                "rr_min": null,
                "note": null
              },
              "rr_min_effective": 1.5,
              "rr_from_adx": 1.5,
              "rr_info": {
                "mode": "trend"
              },
              "blockers": [
                "triggers"
              ]
            }
          }
        },
        "execution_playbook": [
          {
            "step": "precision_limit",
            "description": "Precision parkolt limit belépő 86955.35309–87042.73383 — 16 perc timeout",
            "direction": "sell",
            "confidence": "medium",
            "entry_window": [
              86955.35308571428,
              87042.73382857142
            ],
            "timeout_minutes": 16
          },
          {
            "step": "precision_trigger",
            "state": "fire",
            "description": "Precision trigger: fire",
            "entry_window": [
              86955.35308571428,
              87042.73382857142
            ],
            "trigger_levels": {
              "window_low": 86955.35308571428,
              "window_high": 87042.73382857142,
              "fire": 86984.48,
              "arm": 86955.35308571428,
              "disarm": 87042.73382857142
            },
            "ready_ts": "2025-12-30T02:58:00Z",
            "score": 62.0,
            "score_threshold": 49.0,
            "score_ready": true,
            "trigger_ready": true,
            "order_flow_ready": true,
            "order_flow_strength": null,
            "trigger_progress": 1.0,
            "trigger_confidence": 0.54,
            "reasons": [
              "price hit entry",
              "order flow stalled override"
            ]
          }
        ]
      },
      "intervention_watch": {
        "irs": 20,
        "band": "LOW",
        "since_utc": "2025-12-30T03:01:31Z",
        "updated_utc": "2025-12-30T03:01:31Z",
        "reasons": [
          "ATR elevated 1.5×"
        ],
        "policy": [
          "increase_spread_buffer_when_volatility>=1.5×",
          "discord_alert_cooldown:10m"
        ],
        "metrics": {
          "price": 86984.48,
          "roc_30m_pct": 0.1906240243183664,
          "roc_5m_pct": 0.010888185008545747,
          "atr5_usd": 121.36214285714232,
          "atr5_ratio": 1.5337819844461535,
          "range_position_pct": 8.47890410958893,
          "session_points": 0.0,
          "comms_points": 0.0,
          "comms_from_flag": 0.0,
          "comms_from_sentiment": 0.0,
          "sentiment_score": null,
          "components": {
            "speed": 0.0,
            "volatility": 10.0,
            "range": 10.0,
            "comms": 0.0
          },
          "variance_ratio": 0.1752863276741909
        },
        "score_breakdown": {
          "speed": 0.0,
          "volatility": 10.0,
          "range": 10.0,
          "comms": 0.0
        },
        "news_flag": 0
      },
      "trade_levels": {},
      "position_state": {
        "tracking_enabled": true,
        "side": null,
        "has_position": false,
        "cooldown_active": false,
        "cooldown_until_utc": null,
        "opened_at_utc": null,
        "entry": null,
        "sl": null,
        "tp1": null,
        "tp2": null
      },
      "intent": "standby",
      "actionable": false,
      "notify": {
        "should_notify": false,
        "reason": "non_actionable",
        "cooldown_until_utc": null
      }
    },
    "USOIL": {
      "asset": "USOIL",
      "ok": true,
      "retrieved_at_utc": "2025-12-30T03:01:31Z",
      "source": "Twelve Data (lokális JSON)",
      "spot": {
        "price": 57.86,
        "utc": "2025-12-30T03:00:59Z",
        "retrieved_at_utc": "2025-12-30T03:00:59Z",
        "source": "twelvedata:quote",
        "realtime_override": false,
        "fallback_used": false,
        "confidence": 1.0,
        "avg_latency_profile": 32.0,
        "realtime_stats": null
      },
      "signal": "no entry",
      "probability": 0,
      "probability_raw": 0,
      "entry": null,
      "sl": null,
      "tp1": null,
      "tp2": null,
      "rr": null,
      "leverage": 20.0,
      "position_size_scale": 0.04375,
      "range_time_stop": null,
      "funding_filter": null,
      "funding_rate": null,
      "stale_timeframes": {
        "k1m": false,
        "k5m": false,
        "k1h": false,
        "k4h": false
      },
      "biases": {
        "raw_4h": "neutral",
        "raw_1h": "long",
        "adjusted_4h": "neutral",
        "adjusted_1h": "long"
      },
      "gates": {
        "mode": "core",
        "required": [
          "session",
          "spread_guard",
          "data_integrity",
          "risk_reward",
          "structure(2of3)",
          "intraday_range_guard",
          "atr",
          "rr_math>=1.5",
          "tp_min_profit",
          "min_stoploss",
          "tp1_net>=+0.4%"
        ],
        "missing": [
          "P_score>=36"
        ],
        "session_window_status": {
          "entry_open": true,
          "monitor_window": true,
          "status": "open",
          "status_note": "Piac nyitva",
          "összefoglaló": "Entry ablak NYITVA, Megfigyelés aktív"
        },
        "intraday_bias": {
          "configured": true,
          "allow_neutral": true,
          "scenarios": [
            {
              "direction": "long",
              "requires": [
                "struct_retest_long",
                "atr_ok"
              ],
              "missing": [
                "struct_retest_long",
                "atr_ok"
              ],
              "met": false,
              "label": "USOIL retest long  ATR",
              "missing_pretty": [
                "5m retest long",
                "ATR gate"
              ],
              "requires_pretty": [
                "5m retest long",
                "ATR gate"
              ]
            },
            {
              "direction": "short",
              "requires": [
                "struct_retest_short",
                "atr_ok"
              ],
              "missing": [
                "struct_retest_short",
                "atr_ok"
              ],
              "met": false,
              "label": "USOIL retest short  ATR",
              "missing_pretty": [
                "5m retest short",
                "ATR gate"
              ],
              "requires_pretty": [
                "5m retest short",
                "ATR gate"
              ]
            }
          ],
          "matched": false
        }
      },
      "gate_skips": [
        "liquidity_no_data",
        "orderflow_no_data"
      ],
      "session_info": {
        "open": true,
        "entry_open": true,
        "within_window": true,
        "within_entry_window": true,
        "within_monitor_window": true,
        "weekday_ok": true,
        "now_utc": "2025-12-30T03:01:31.372127+00:00",
        "now_budapest": "2025-12-30T04:01:31.372127+01:00",
        "windows_utc": [
          [
            0,
            0,
            22,
            0
          ]
        ],
        "time_zone": "Europe/Berlin",
        "time_zone_budapest": "Europe/Budapest",
        "windows_local_cet": [
          [
            "01:00",
            "23:00"
          ]
        ],
        "windows_local_budapest": [
          [
            "01:00",
            "23:00"
          ]
        ],
        "allowed_weekdays": [
          0,
          1,
          2,
          3,
          4,
          6
        ],
        "status_profile": "default",
        "sunday_open_utc": "23:00",
        "sunday_open_budapest": "00:00",
        "minutes_to_session_close": 1139,
        "session_close_reason": "entry_window",
        "next_session_open_utc": "2025-12-31T00:00:00+00:00",
        "next_session_open_budapest": "2025-12-31T01:00:00+01:00",
        "status": "open",
        "status_note": "Piac nyitva",
        "notes": [
          "Alapértelmezett session profil — valós idejű nyitvatartási szabályok érvényesek"
        ],
        "next_open_utc": "2025-12-31T00:00:00+00:00"
      },
      "momentum_diagnostics": {
        "evaluated": true,
        "used_for_decision": false,
        "direction_result": null,
        "required": [
          "session",
          "regime",
          "bias",
          "momentum_trigger",
          "structure(2of3)",
          "atr",
          "rr_math>=1.3",
          "tp_min_profit",
          "min_stoploss",
          "tp1_net>=+0.4%",
          "intraday_range_guard"
        ],
        "missing": [
          "regime",
          "bias"
        ],
        "liquidity_data_available": false,
        "flow_data_available": false,
        "ofi_available": false,
        "momentum_trigger_ok": null,
        "momentum_atr_ok": null,
        "trigger_desc": null,
        "precision_data_gap_mode": false
      },
      "diagnostics": {
        "timeframes": {
          "k1m": {
            "last_raw_utc": "2025-12-30T02:59:00Z",
            "last_closed_utc": "2025-12-30T02:59:00Z",
            "latency_seconds": 151,
            "expected_max_delay_seconds": 180,
            "source_mtime_utc": "2025-12-30T03:01:10Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 240.0,
            "freshness_violation": false,
            "freshness_retries": 0,
            "used_symbol": "WTI/USD",
            "used_exchange": "COMMODITY",
            "retrieved_at_utc": "2025-12-30T03:01:10Z",
            "latency_guard_seconds": 130,
            "latency_guard_adjustment_seconds": 21,
            "critical_stale": false
          },
          "k5m": {
            "last_raw_utc": "2025-12-30T02:55:00Z",
            "last_closed_utc": "2025-12-30T02:55:00Z",
            "latency_seconds": 391,
            "expected_max_delay_seconds": 300,
            "source_mtime_utc": "2025-12-30T03:01:11Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 900.0,
            "freshness_violation": false,
            "freshness_retries": 0,
            "used_symbol": "WTI/USD",
            "used_exchange": "COMMODITY",
            "retrieved_at_utc": "2025-12-30T03:01:11Z",
            "latency_guard_seconds": 371,
            "latency_guard_adjustment_seconds": 20,
            "critical_stale": false
          },
          "k1h": {
            "last_raw_utc": "2025-12-30T02:00:00Z",
            "last_closed_utc": "2025-12-30T02:00:00Z",
            "latency_seconds": 3691,
            "expected_max_delay_seconds": 3600,
            "source_mtime_utc": "2025-12-30T03:01:08Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 5400.0,
            "freshness_violation": false,
            "freshness_retries": 0,
            "used_symbol": "WTI/USD",
            "used_exchange": "COMMODITY",
            "retrieved_at_utc": "2025-12-30T03:01:08Z",
            "latency_guard_seconds": 3668,
            "latency_guard_adjustment_seconds": 23,
            "critical_stale": false
          },
          "k4h": {
            "last_raw_utc": "2025-12-30T00:00:00Z",
            "last_closed_utc": "2025-12-30T00:00:00Z",
            "latency_seconds": 10891,
            "expected_max_delay_seconds": 14400,
            "source_mtime_utc": "2025-12-30T03:01:06Z",
            "stale_for_signals": false,
            "freshness_limit_seconds": 21600.0,
            "freshness_violation": false,
            "freshness_retries": 0,
            "used_symbol": "WTI/USD",
            "used_exchange": "COMMODITY",
            "retrieved_at_utc": "2025-12-30T03:01:06Z",
            "latency_guard_seconds": 10866,
            "latency_guard_adjustment_seconds": 25,
            "critical_stale": false
          },
          "spot": {
            "last_raw_utc": "2025-12-30T03:00:59Z",
            "latency_seconds": 32,
            "expected_max_delay_seconds": 900,
            "source_mtime_utc": "2025-12-30T03:01:11Z",
            "source": "twelvedata:quote",
            "fallback_used": false,
            "realtime_override": false,
            "freshness_limit_seconds": 900.0,
            "freshness_retries": 0,
            "freshness_violation": false,
            "freshness_violation_meta": false,
            "used_symbol": "WTI/USD",
            "used_exchange": "COMMODITY"
          }
        },
        "source_files": {
          "spot.json": "2025-12-30T03:01:11Z",
          "klines_1m.json": "2025-12-30T03:01:10Z",
          "klines_5m.json": "2025-12-30T03:01:11Z",
          "klines_1h.json": "2025-12-30T03:01:08Z",
          "klines_4h.json": "2025-12-30T03:01:06Z"
        },
        "latency_flags": [],
        "refresh_tips": [
          "Az analysis.py mindig a legutóbbi ZÁRT gyertyával számol (5m: max. ~5 perc késés).",
          "CI/CD-ben kösd össze a Trading és Analysis futást: az analysis job csak a trading után induljon (needs: trading).",
          "A kliens kéréséhez adj cache-busting query paramot (pl. ?v=<timestamp>) és no-store cache-control fejlécet.",
          "Cloudflare Worker stale policy: 5m feedre állítsd 120s-re, hogy hamar átjöjjön az új jel.",
          "A dashboard stabilizáló (2 azonos jel + 10 perc cooldown) lassíthatja a kártya frissítését — lazítsd, ha realtime kell."
        ]
      },
      "reasons": [
        "Intraday bias gate feltételek hiányosak — USOIL retest long  ATR: 5m retest long, ATR gate | USOIL retest short  ATR: 5m retest short, ATR gate",
        "Bias neutrálsávban",
        "Regime filter inaktív",
        "ATR nincs rendben (relatív vagy abszolút küszöb)",
        "Range expanzió támogatja a momentumot (+3.0)",
        "USOIL: erős momentum — invalid zóna 2.5×ATR(1h)-re tágítva",
        "Fib zóna konfluencia (0.618–0.886) (+18.0)",
        "P-Score reduced by 4.0 due to regime CHOPPY",
        "USOIL: 1h ATR <1 USD — P-score küszöb emelve a zajos sáv miatt",
        "USOIL: csökkenő volatilitás — RR cél 1:1.5-re igazítva",
        "USOIL: ázsiai sáv — pozícióméret ×0.70",
        "Regime kapu: CHOPPY miatt −10 P-score, pozícióskálázás csökkentve",
        "ATR soft gate: alacsony volatilitás −5 P-score, méret felezve",
        "Bias eltérés: H1 trend ütközik az M5 belépéssel (−15 P-score)",
        "Strukturális kapu lazítva: momentum erős, BOS hiány engedve",
        "Liquidity gate skipped (no volume proxy available)",
        "Order-flow gates skipped (no tick/imbalance data)",
        "missing: P_score>=36"
      ],
      "realtime_transport": "http",
      "data_integrity_diagnostics": {
        "core_data_ok": true,
        "precision_data_ok": true,
        "precision_disabled_due_to_data_gap": false,
        "core_required_sources": [
          "spot",
          "k5m"
        ],
        "precision_required_sources": [
          "spot",
          "k5m",
          "k1m"
        ],
        "spot": {
          "last_raw_utc": "2025-12-30T03:00:59Z",
          "latency_seconds": 32,
          "expected_max_delay_seconds": 900,
          "source_mtime_utc": "2025-12-30T03:01:11Z",
          "source": "twelvedata:quote",
          "fallback_used": false,
          "realtime_override": false,
          "freshness_limit_seconds": 900.0,
          "freshness_retries": 0,
          "freshness_violation": false,
          "freshness_violation_meta": false,
          "used_symbol": "WTI/USD",
          "used_exchange": "COMMODITY"
        },
        "k5m": {
          "last_raw_utc": "2025-12-30T02:55:00Z",
          "last_closed_utc": "2025-12-30T02:55:00Z",
          "latency_seconds": 391,
          "expected_max_delay_seconds": 300,
          "source_mtime_utc": "2025-12-30T03:01:11Z",
          "stale_for_signals": false,
          "freshness_limit_seconds": 900.0,
          "freshness_violation": false,
          "freshness_retries": 0,
          "used_symbol": "WTI/USD",
          "used_exchange": "COMMODITY",
          "retrieved_at_utc": "2025-12-30T03:01:11Z",
          "latency_guard_seconds": 371,
          "latency_guard_adjustment_seconds": 20,
          "critical_stale": false
        },
        "k1m": {
          "last_raw_utc": "2025-12-30T02:59:00Z",
          "last_closed_utc": "2025-12-30T02:59:00Z",
          "latency_seconds": 151,
          "expected_max_delay_seconds": 180,
          "source_mtime_utc": "2025-12-30T03:01:10Z",
          "stale_for_signals": false,
          "freshness_limit_seconds": 240.0,
          "freshness_violation": false,
          "freshness_retries": 0,
          "used_symbol": "WTI/USD",
          "used_exchange": "COMMODITY",
          "retrieved_at_utc": "2025-12-30T03:01:10Z",
          "latency_guard_seconds": 130,
          "latency_guard_adjustment_seconds": 21,
          "critical_stale": false
        }
      },
      "profile_resolution": {
        "asset": "USOIL",
        "entry_profile": "baseline",
        "global_default_profile": null,
        "schedule_enabled": true,
        "schedule_bucket": "mid",
        "schedule_selected_profile": "baseline",
        "resolution_notes": [
          "profile via schedule bucket mid -> baseline"
        ]
      },
      "effective_thresholds": {
        "asset": "USOIL",
        "entry_profile": "baseline",
        "p_score_min": 36.0,
        "spread_max_atr_pct": 0.65,
        "tp_net_min": 0.004,
        "rr_required": null,
        "tp_min_profit_pct": null,
        "min_stoploss_pct": 0.01,
        "atr_abs_min_used": 0.16,
        "atr_low_threshold": 0.0017205783427802737,
        "atr_overlay_min": null,
        "bos_lookback": 45,
        "fib_tolerance": 0.012,
        "position_scale_floor": 0.04,
        "staleness_max_age_seconds": 900,
        "session_window": {
          "entry": [
            [
              0,
              0,
              22,
              0
            ]
          ],
          "monitor": [
            [
              0,
              0,
              22,
              0
            ]
          ]
        }
      },
      "probability_model_source": "sklearn",
      "probability_model": null,
      "probability_model_raw": null,
      "probability_calibrated": null,
      "probability_threshold": null,
      "probability_stack": {
        "source": "sklearn",
        "status": "disabled",
        "unavailable_reason": "ml_scoring_disabled"
      },
      "ema21_slope_1h": 0.0025475003733498834,
      "ema21_slope_threshold": 0.019,
      "ema21_relation_1h": "above",
      "last_swing_high_1h": 57.810001,
      "last_swing_low_1h": 57.799999,
      "last_close_1h": 57.860001,
      "bos_5m_dir": "bos_up",
      "atr1h": 0.29142914285714333,
      "momentum_volume_ratio": null,
      "momentum_liquidity_ok": true,
      "dynamic_tp_profile": {
        "core": {
          "tp1": 1.8,
          "tp2": 2.7,
          "rr": 1.3
        },
        "momentum": {
          "tp1": 1.5,
          "tp2": 2.4,
          "rr": 1.1
        },
        "regime": "compressed",
        "reference": {
          "current": 0.11071392857142978,
          "q20": 0.09657171428571446,
          "q50": 0.12214378571428545,
          "q80": 0.14342845714285643
        }
      },
      "order_flow_metrics": {
        "imbalance": null,
        "pressure": 0.0,
        "delta_volume": 0.0,
        "aggressor_ratio": null,
        "imbalance_z": null,
        "status": "ok"
      },
      "intraday_profile": {
        "asset": "USOIL",
        "timestamp": "2025-12-30T03:01:31Z",
        "day_start_utc": "2025-12-29T23:00:00Z",
        "day_open": 57.650002,
        "day_high": 57.939999,
        "day_low": 57.599998,
        "day_range": 0.3400010000000009,
        "range_vs_atr": 3.0709866806021697,
        "range_position": 0.7647095155602466,
        "range_bias": "upper",
        "range_state": "expansion",
        "range_compression": false,
        "range_expansion": true,
        "range_exhaustion_long": false,
        "range_exhaustion_short": false,
        "range_guard": {
          "long": false,
          "short": false
        },
        "micro_range_position": 0.6190553288348895,
        "micro_range_vs_atr": 1.8967712799073644,
        "micro_range_guard": {
          "long": false,
          "short": false
        },
        "opening_range_high": 57.810001,
        "opening_range_low": 57.639999,
        "opening_break": "both",
        "opening_range_minutes": 45,
        "opening_drive_ratio": 0.5000044117517191,
        "previous_close": 57.830002,
        "opening_gap": -0.17999999999999972,
        "opening_gap_pct": -0.31125712221140805,
        "opening_gap_direction": "down",
        "price_reference": 57.86,
        "elapsed_minutes": 241,
        "notes": [
          "Range expanzió >1.5×ATR — agresszív menedzsment indokolt.",
          "Opening range áttörés iránya: both."
        ]
      },
      "entry_thresholds": {
        "profile": "baseline",
        "usoil_overrides": {
          "momentum_stop": {
            "atr_multiplier": 2.5,
            "buffer": 0.7285728571428584
          },
          "vwap_distance": null,
          "vwap_bias": {
            "lookback_minutes": 0,
            "above_ratio": null,
            "below_ratio": null,
            "bias": "neutral"
          },
          "gap_context": {
            "pct": -0.31125712221140805,
            "direction": "down",
            "gap_vwap_break_long": false,
            "gap_vwap_break_short": false
          },
          "p_score_adjustments": {
            "atr1h": 0.29142914285714333,
            "low_atr_add": 6.0
          },
          "rr_adjustments": {
            "atr1h": 0.29142914285714333,
            "core_rr_min": 1.6,
            "momentum_rr_min": 1.6,
            "regime": "muted",
            "core_rr_min_effective": 1.5,
            "momentum_rr_min_effective": 1.3
          },
          "position_scale": {
            "session": "asia",
            "session_scale": 0.7,
            "atr1h": 0.29142914285714333,
            "low_vol_scale": 0.75,
            "applied": 0.7
          }
        },
        "news_lockout": false,
        "adx_value": 61.688001014913105,
        "adx_trend_threshold": 20.0,
        "adx_regime_initial": "balanced",
        "atr_multiplier": 0.0,
        "atr_threshold_base": 0.0,
        "atr_threshold_initial": 0.0,
        "atr_percentile_meta": {
          "bucket": "mid",
          "samples": 203,
          "percentile": 0.25,
          "threshold": 0.0017205783427802737
        },
        "atr_threshold_percentile": 0.0017205783427802737,
        "spread_ratio": null,
        "atr_soft_gate": {
          "enabled": true,
          "rel_atr": 0.0019134795812552675,
          "threshold": 0.0017205783427802737,
          "tolerance_pct": 0.15,
          "penalty_max": 6.0,
          "diff_ratio": -0.11211418491022364,
          "mode": "pass"
        },
        "atr_ratio_ok": true,
        "atr_threshold_effective": 0.0017205783427802737,
        "spread_gate_ok": true,
        "atr_abs_min_used": 0.16,
        "atr_abs_override_applied": true,
        "risk_guard": {
          "profile": "baseline",
          "max_risk_pct": 1.6,
          "spread_gate_ok": true,
          "allowed": true,
          "cost_model": {
            "type": "pct",
            "round_trip_pct": 0.0007,
            "overnight_pct": 0.0002
          }
        },
        "fib_tolerance_fraction": 0.012,
        "dynamic_score_engine": {
          "base_score": 24.0,
          "regime_penalty": {
            "label": "CHOPPY",
            "points": -4.0
          },
          "final_score": 20.0
        },
        "ofi_z": null,
        "vwap_confluence": {
          "trend_pullback": false,
          "mean_revert": false
        },
        "structure_components": {
          "bos": false,
          "liquidity": true,
          "ofi": false
        },
        "p_score_min_base": 30.0,
        "bias_meta": "neutral",
        "bias_micro": null,
        "p_score_min_effective": 36.0,
        "adx_regime": "balanced",
        "position_size_scale": 0.7,
        "rr_min_core": 1.5,
        "rr_min_momentum": 1.3,
        "rr_meta": {
          "core_rr_min_base": 1.5,
          "momentum_rr_min_base": 1.3,
          "core_rr_min": 1.5,
          "momentum_rr_min": 1.3
        },
        "precision_score_threshold": 55.0,
        "precision_timeouts": {
          "ready": 15,
          "arming": 20
        }
      },
      "entry_gate_context_hu": {
        "atr_kapu": {
          "ok": false,
          "rel_atr": 0.0019134795812552675,
          "threshold": 0.0017205783427802737,
          "abs_ok": false,
          "overlay_ok": true,
          "btc_atr_gate": true,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "spread_kapu": {
          "ok": true,
          "spread_ratio_atr": null,
          "spread_limit_atr": 0.65,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "kockazat_guard": {
          "max_risk_pct": 1.6,
          "engedi": true,
          "cost_model": {
            "type": "pct",
            "round_trip_pct": 0.0007,
            "overnight_pct": 0.0002
          },
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "profil_kuszobok": {
          "profil": "baseline",
          "p_score_min": 30.0,
          "p_score_min_base": 30.0,
          "atr_kuszob_rel": 0.0017205783427802737,
          "atr_abs_min": 0.16,
          "fib_tures_frac": 0.012,
          "fib_tures_atr": 0.21857185714285748,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "bos_visszatekintes": 45,
        "fib_zona": {
          "ok": true,
          "sav": [
            0.618,
            0.886
          ],
          "tures_frac": 0.012,
          "tures_atr": 0.21857185714285748,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "session_ablak_utc": {
          "entry": [
            [
              0,
              0,
              22,
              0
            ]
          ],
          "monitor": [
            [
              0,
              0,
              22,
              0
            ]
          ]
        },
        "p_score_profil": "baseline",
        "structure_kapu": {
          "ok": false,
          "komponensek": {
            "bos": false,
            "liquidity": true,
            "ofi": false
          },
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "rr_kapuk": {
          "core_rr_min": 1.5,
          "momentum_rr_min": 1.3,
          "relaxalt": false,
          "indok": null,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31"
        },
        "momentum_kapu": {
          "momentum_ok": false,
          "momentum_direction": null,
          "momentum_reason": "missing:bias,regime",
          "momentum_missing": [
            "regime",
            "bias"
          ],
          "momentum_regime_ok": false,
          "momentum_structure_ok": false,
          "momentum_atr_ok": false,
          "momentum_liquidity_ok": true,
          "momentum_trigger_ok": false,
          "momentum_ofi_z": null,
          "timestamp_utc": "2025-12-30 03:01:31",
          "timestamp_bud": "2025-12-30 04:01:31",
          "momentum_asset_class": "energy_equity"
        }
      },
      "volatility_overlay": {
        "implied_vol": null,
        "realised_vol": 0.0006925940390341891,
        "realised_window_minutes": 120,
        "regime": "historical",
        "premium": null,
        "source_path": null,
        "implied_realised_ratio": null
      },
      "invalid_levels": {
        "buy": 57.65428442857143,
        "sell": 57.95571557142857
      },
      "invalid_buffer_abs": 0.7285728571428584,
      "action_plan": {
        "status": "standby",
        "priority": "low",
        "summary": "Nincs belépő – dolgozd le a hiányzó feltételeket.",
        "steps": [],
        "blockers": [
          "P_score>=36"
        ],
        "blockers_raw": [
          "P_score>=36"
        ],
        "notes": [
          "Range expanzió >1.5×ATR — agresszív menedzsment indokolt.",
          "Opening range áttörés iránya: both.",
          "Összesített valószínűség: 0%.",
          "Ajánlott tőkeáttétel: ×20.0.",
          "Intraday bias gate feltételek hiányosak — USOIL retest long  ATR: 5m retest long, ATR gate | USOIL retest short  ATR: 5m retest short, ATR gate",
          "Bias neutrálsávban",
          "Regime filter inaktív",
          "ATR nincs rendben (relatív vagy abszolút küszöb)",
          "Range expanzió támogatja a momentumot (+3.0)",
          "USOIL: erős momentum — invalid zóna 2.5×ATR(1h)-re tágítva"
        ],
        "context": {
          "asset": "USOIL",
          "decision": "no entry",
          "probability": 0,
          "session_open": true,
          "session_entry_open": true,
          "session_status": "open",
          "intraday_profile": {
            "range_state": "expansion",
            "range_position": 0.7647095155602466,
            "range_vs_atr": 3.0709866806021697,
            "range_guard": {
              "long": false,
              "short": false
            },
            "opening_break": "both"
          },
          "next_session_open_utc": "2025-12-31T00:00:00+00:00"
        }
      },
      "entry_diagnostics": {
        "required": [
          "session",
          "spread_guard",
          "data_integrity",
          "risk_reward",
          "structure(2of3)",
          "intraday_range_guard",
          "atr",
          "rr_math>=1.5",
          "tp_min_profit",
          "min_stoploss",
          "tp1_net>=+0.4%"
        ],
        "missing": [
          "P_score>=36"
        ],
        "blockers": [
          "P_score>=36"
        ],
        "p_score_used": 0
      },
      "position_diagnostics": {
        "state": null,
        "severity": null,
        "reasons": [],
        "p_score_used": 0
      },
      "active_position_meta": {
        "ema21_slope_abs": 0.0025475003733498834,
        "ema21_slope_signed": 0.0025475003733498834,
        "ema21_slope_threshold": 0.019,
        "ema21_relation": "above",
        "structure_5m": "bos_up",
        "stale_timeframes": {
          "k1m": false,
          "k5m": false,
          "k1h": false,
          "k4h": false
        },
        "atr1h": 0.29142914285714333,
        "atr1h_trail_floor": 0.7285728571428584,
        "atr5": 0.11071392857142978,
        "atr5_rel": 0.0019134795812552675,
        "atr5_threshold": 0.0017205783427802737,
        "bos1h_long": true,
        "bos1h_short": true,
        "regime_ok": false,
        "effective_bias": "neutral",
        "last_close_1h": 57.860001,
        "last_swing_high_1h": 57.810001,
        "last_swing_low_1h": 57.799999,
        "invalid_level_sell": 57.95571557142857,
        "invalid_level_buy": 57.65428442857143,
        "invalid_buffer_abs": 0.7285728571428584,
        "p_score": 0,
        "probability_calibrated": null,
        "probability_threshold": null,
        "probability_model_raw": null,
        "probability_model_source": "sklearn",
        "tp_profile": {
          "tp1_r": 1.8,
          "tp2_r": 2.7
        },
        "realtime_confidence": 1.0,
        "avg_latency_profile": 32.0,
        "action_plan": {
          "status": "standby",
          "priority": "low",
          "summary": "Nincs belépő – dolgozd le a hiányzó feltételeket.",
          "steps": [],
          "blockers": [
            "P_score>=36"
          ],
          "blockers_raw": [
            "P_score>=36"
          ],
          "notes": [
            "Range expanzió >1.5×ATR — agresszív menedzsment indokolt.",
            "Opening range áttörés iránya: both.",
            "Összesített valószínűség: 0%.",
            "Ajánlott tőkeáttétel: ×20.0.",
            "Intraday bias gate feltételek hiányosak — USOIL retest long  ATR: 5m retest long, ATR gate | USOIL retest short  ATR: 5m retest short, ATR gate",
            "Bias neutrálsávban",
            "Regime filter inaktív",
            "ATR nincs rendben (relatív vagy abszolút küszöb)",
            "Range expanzió támogatja a momentumot (+3.0)",
            "USOIL: erős momentum — invalid zóna 2.5×ATR(1h)-re tágítva"
          ],
          "context": {
            "asset": "USOIL",
            "decision": "no entry",
            "probability": 0,
            "session_open": true,
            "session_entry_open": true,
            "session_status": "open",
            "intraday_profile": {
              "range_state": "expansion",
              "range_position": 0.7647095155602466,
              "range_vs_atr": 3.0709866806021697,
              "range_guard": {
                "long": false,
                "short": false
              },
              "opening_break": "both"
            },
            "next_session_open_utc": "2025-12-31T00:00:00+00:00"
          }
        }
      },
      "trade_levels": {},
      "position_state": {
        "tracking_enabled": true,
        "side": null,
        "has_position": false,
        "cooldown_active": false,
        "cooldown_until_utc": null,
        "opened_at_utc": null,
        "entry": null,
        "sl": null,
        "tp1": null,
        "tp2": null
      },
      "intent": "standby",
      "actionable": false,
      "notify": {
        "should_notify": false,
        "reason": "non_actionable",
        "cooldown_until_utc": null
      }
    }
  },
  "latency_flags": [],
  "sentiment_alerts": [],
  "troubleshooting": [
    "Az analysis.py mindig a legutóbbi ZÁRT gyertyával számol (5m: max. ~5 perc késés).",
    "CI/CD-ben kösd össze a Trading és Analysis futást: az analysis job csak a trading után induljon (needs: trading).",
    "A kliens kéréséhez adj cache-busting query paramot (pl. ?v=<timestamp>) és no-store cache-control fejlécet.",
    "Cloudflare Worker stale policy: 5m feedre állítsd 120s-re, hogy hamar átjöjjön az új jel.",
    "A dashboard stabilizáló (2 azonos jel + 10 perc cooldown) lassíthatja a kártya frissítését — lazítsd, ha realtime kell.",
    "ML valószínűség számítás ideiglenesen letiltva (ML valószínűség manuálisan letiltva: modell tréning alatt; flag letiltva (ENABLE_ML_PROBABILITY=0))."
  ],
  "run_context": {
    "run_id": "20587750417",
    "started_at_utc": "2025-12-30T03:01:31Z",
    "captured_at_utc": "2025-12-30T03:01:31Z",
    "weekday": 1
  },
  "analysis_revision": {
    "commit": "5070a352f88ba4ddd358b88dce964617512cd0c6",
    "branch": "main",
    "describe": "5070a35",
    "dirty": false
  },
  "pipeline_monitoring": {
    "run": {
      "run_id": "20587750417",
      "captured_at_utc": "2025-12-30T03:01:31Z",
      "started_at_utc": "2025-12-30T03:01:31Z"
    },
    "trading": {
      "started_utc": "2025-12-30T03:00:42Z",
      "completed_utc": "2025-12-30T03:01:28Z",
      "duration_seconds": 46.041
    },
    "updated_utc": "2025-12-30T03:01:31Z",
    "localized_times": {
      "timezone": "Europe/Budapest",
      "run": {
        "captured_at_local": "2025-12-30T04:01:31+01:00",
        "started_at_local": "2025-12-30T04:01:31+01:00"
      },
      "trading": {
        "started_local": "2025-12-30T04:00:42+01:00",
        "completed_local": "2025-12-30T04:01:28+01:00"
      },
      "analysis": {
        "started_local": "2025-12-30T04:01:31+01:00"
      },
      "updated_local": "2025-12-30T04:01:31+01:00"
    },
    "execution_order": {
      "analysis_started_utc": "2025-12-30T03:01:31Z",
      "trading_completed_utc": "2025-12-30T03:01:28Z",
      "analysis_after_trading": true
    },
    "analysis": {
      "started_utc": "2025-12-30T03:01:31Z",
      "lag_from_trading_seconds": 3.086,
      "lag_threshold_seconds": 800,
      "lag_breached": false
    }
  },
  "entry_counts": {
    "generated_utc": "2025-12-30T03:01:31Z",
    "window_days": 14,
    "by_day_asset": {},
    "by_asset_total": {}
  }
}</pre>