{
  "asset": "BTCUSD",
  "ok": true,
  "retrieved_at_utc": "2025-10-24T21:01:39Z",
  "source": "Twelve Data (lokális JSON)",
  "spot": {
    "price": 110935.56,
    "utc": "2025-10-24T20:55:43+00:00",
    "retrieved_at_utc": "2025-10-24T20:55:43+00:00",
    "source": "twelvedata:quote",
    "realtime_override": false,
    "fallback_used": false,
    "confidence": 0.4532303370786517,
    "avg_latency_profile": 161.35,
    "realtime_stats": null
  },
  "signal": "market closed",
  "probability": 0,
  "probability_raw": 0,
  "entry": null,
  "sl": null,
  "tp1": null,
  "tp2": null,
  "rr": null,
  "leverage": 2,
  "stale_timeframes": {
    "k1m": true,
    "k5m": false,
    "k1h": false,
    "k4h": false
  },
  "biases": {
    "raw_4h": "neutral",
    "raw_1h": "long",
    "adjusted_4h": "neutral",
    "adjusted_1h": "long"
  },
  "gates": {
    "mode": "session_closed",
    "required": [
      "session"
    ],
    "missing": [
      "session",
      "regime",
      "bias",
      "bos5m",
      "liquidity",
      "atr",
      "P_score>=60"
    ]
  },
  "session_info": {
    "open": false,
    "entry_open": false,
    "within_window": false,
    "within_entry_window": false,
    "within_monitor_window": false,
    "weekday_ok": true,
    "now_utc": "2025-10-24T21:01:39.414153+00:00",
    "windows_utc": [
      [
        0,
        0,
        23,
        59
      ]
    ],
    "time_zone": "Europe/Berlin",
    "windows_local_cet": [
      [
        "02:00",
        "01:59"
      ]
    ],
    "special_closure_reason": "friday_close",
    "status": "closed_out_of_hours",
    "status_note": "Piac zárva (pénteki zárás 00:00 UTC)",
    "next_open_utc": "2025-10-25T00:00:00+00:00"
  },
  "diagnostics": {
    "timeframes": {
      "k1m": {
        "last_raw_utc": "2025-10-24T20:54:00Z",
        "last_closed_utc": "2025-10-24T20:54:00Z",
        "latency_seconds": 459,
        "expected_max_delay_seconds": 180,
        "source_mtime_utc": "2025-10-24T21:01:19Z",
        "stale_for_signals": true,
        "freshness_limit_seconds": 420.0,
        "freshness_violation": false,
        "freshness_retries": 0,
        "used_symbol": "BTC/USD",
        "used_exchange": null
      },
      "k5m": {
        "last_raw_utc": "2025-10-24T20:50:00Z",
        "last_closed_utc": "2025-10-24T20:50:00Z",
        "latency_seconds": 699,
        "expected_max_delay_seconds": 300,
        "source_mtime_utc": "2025-10-24T21:01:19Z",
        "stale_for_signals": false,
        "freshness_limit_seconds": 1200.0,
        "freshness_violation": false,
        "freshness_retries": 0,
        "used_symbol": "BTC/USD",
        "used_exchange": null
      },
      "k1h": {
        "last_raw_utc": "2025-10-24T20:00:00Z",
        "last_closed_utc": "2025-10-24T20:00:00Z",
        "latency_seconds": 3699,
        "expected_max_delay_seconds": 3600,
        "source_mtime_utc": "2025-10-24T21:01:19Z",
        "stale_for_signals": false,
        "freshness_limit_seconds": 9000.0,
        "freshness_violation": false,
        "freshness_retries": 0,
        "used_symbol": "BTC/USD",
        "used_exchange": null
      },
      "k4h": {
        "last_raw_utc": "2025-10-24T20:00:00Z",
        "last_closed_utc": "2025-10-24T20:00:00Z",
        "latency_seconds": 3699,
        "expected_max_delay_seconds": 14400,
        "source_mtime_utc": "2025-10-24T21:01:19Z",
        "stale_for_signals": false,
        "freshness_limit_seconds": 36000.0,
        "freshness_violation": false,
        "freshness_retries": 0,
        "used_symbol": "BTC/USD",
        "used_exchange": null
      },
      "spot": {
        "last_raw_utc": "2025-10-24T20:55:43Z",
        "latency_seconds": 356,
        "expected_max_delay_seconds": 300,
        "source_mtime_utc": "2025-10-24T21:01:19Z",
        "source": "twelvedata:quote",
        "fallback_used": false,
        "realtime_override": false,
        "freshness_limit_seconds": 900.0,
        "freshness_retries": 0,
        "freshness_violation": false,
        "freshness_violation_meta": false,
        "used_symbol": "BTC/USD",
        "used_exchange": null,
        "original_issue": "Spot data stale: 5 min behind (limit 5 min)"
      }
    },
    "source_files": {
      "spot.json": "2025-10-24T21:01:19Z",
      "klines_1m.json": "2025-10-24T21:01:19Z",
      "klines_5m.json": "2025-10-24T21:01:19Z",
      "klines_1h.json": "2025-10-24T21:01:19Z",
      "klines_4h.json": "2025-10-24T21:01:19Z"
    },
    "latency_flags": [
      "spot: spot data stale: 5 min behind (limit 5 min) — session zárva miatt engedve",
      "k1m: utolsó zárt gyertya 7 perc késésben van",
      "k1m: jelzés korlátozva 7 perc késés miatt",
      "k5m: utolsó zárt gyertya 11 perc késésben van"
    ],
    "refresh_tips": [
      "Az analysis.py mindig a legutóbbi ZÁRT gyertyával számol (5m: max. ~5 perc késés).",
      "CI/CD-ben kösd össze a Trading és Analysis futást: az analysis job csak a trading után induljon (needs: trading).",
      "A kliens kéréséhez adj cache-busting query paramot (pl. ?v=<timestamp>) és no-store cache-control fejlécet.",
      "Cloudflare Worker stale policy: 5m feedre állítsd 120s-re, hogy hamar átjöjjön az új jel.",
      "A dashboard stabilizáló (2 azonos jel + 10 perc cooldown) lassíthatja a kártya frissítését — lazítsd, ha realtime kell.",
      "Hiányzó ML modellek: EURUSD, GOLD_CFD, NVDA, SRTY, BTCUSD, USOIL – töltsd fel a public/models/<asset>_gbm.pkl fájlokat a valószínűségi score aktiválásához."
    ]
  },
  "reasons": [
    "Piac zárva (pénteki zárás 00:00 UTC)",
    "Bias neutrálsávban",
    "Regime filter inaktív",
    "ATR nincs rendben (relatív vagy abszolút küszöb)",
    "Alacsony realised vol → magasabb RR igény",
    "Range expanzió támogatja a momentumot (+3.0)",
    "Ár 1h EMA21 zónában (+10.0)",
    "Realtime megbízhatóság alacsony (−1.8)",
    "Diagnosztika: spot: spot data stale: 5 min behind (limit 5 min) — session zárva miatt engedve",
    "Diagnosztika: k1m: utolsó zárt gyertya 7 perc késésben van",
    "Diagnosztika: k1m: jelzés korlátozva 7 perc késés miatt",
    "Diagnosztika: k5m: utolsó zárt gyertya 11 perc késésben van",
    "ML fallback: scikit-learn hiányzik — heurisztikus pontozás aktív",
    "missing: session, regime, bias, bos5m, liquidity, atr, P_score>=60"
  ],
  "realtime_transport": "http",
  "probability_model_source": "fallback",
  "probability_fallback": {
    "base_probability": 0.05,
    "adjusted_logit": -4.550140915395978,
    "probability": 0.010455248229670885,
    "threshold": 0.6,
    "steps": [
      {
        "feature": "bias_neutral_penalty",
        "weight": -0.55,
        "normalized": 1.0,
        "delta": -0.55
      },
      {
        "feature": "rel_atr",
        "weight": 0.35,
        "normalized": 0.2941060248979482,
        "delta": 0.10293710871428186
      },
      {
        "feature": "momentum_vol_ratio",
        "weight": 0.35,
        "normalized": -1.0,
        "delta": -0.35
      },
      {
        "feature": "news_event_severity",
        "weight": 0.25,
        "normalized": -0.5,
        "delta": -0.125
      },
      {
        "feature": "realtime_confidence",
        "weight": 0.9,
        "normalized": -0.22015449438202245,
        "delta": -0.1981390449438202
      },
      {
        "feature": "precision_score",
        "weight": 0.35,
        "normalized": -1.2,
        "delta": -0.42
      },
      {
        "feature": "precision_trigger_confidence",
        "weight": 0.55,
        "normalized": -0.77,
        "delta": -0.42350000000000004
      },
      {
        "feature": "structure_flip_flag",
        "weight": 0.55,
        "normalized": 1.0,
        "delta": 0.55
      },
      {
        "feature": "momentum_trail_lock_ratio",
        "weight": 0.4,
        "normalized": -0.48,
        "delta": -0.192
      }
    ],
    "reason": "sklearn_missing"
  },
  "probability_model": 0.010455248229670885,
  "probability_model_raw": 0.05,
  "probability_calibrated": 0.010455248229670885,
  "probability_threshold": 0.6,
  "probability_stack": {
    "asset": "BTCUSD",
    "unavailable_reason": "sklearn_missing",
    "source": "fallback",
    "fallback": {
      "base_probability": 0.05,
      "adjusted_logit": -4.550140915395978,
      "probability": 0.010455248229670885,
      "threshold": 0.6,
      "steps": [
        {
          "feature": "bias_neutral_penalty",
          "weight": -0.55,
          "normalized": 1.0,
          "delta": -0.55
        },
        {
          "feature": "rel_atr",
          "weight": 0.35,
          "normalized": 0.2941060248979482,
          "delta": 0.10293710871428186
        },
        {
          "feature": "momentum_vol_ratio",
          "weight": 0.35,
          "normalized": -1.0,
          "delta": -0.35
        },
        {
          "feature": "news_event_severity",
          "weight": 0.25,
          "normalized": -0.5,
          "delta": -0.125
        },
        {
          "feature": "realtime_confidence",
          "weight": 0.9,
          "normalized": -0.22015449438202245,
          "delta": -0.1981390449438202
        },
        {
          "feature": "precision_score",
          "weight": 0.35,
          "normalized": -1.2,
          "delta": -0.42
        },
        {
          "feature": "precision_trigger_confidence",
          "weight": 0.55,
          "normalized": -0.77,
          "delta": -0.42350000000000004
        },
        {
          "feature": "structure_flip_flag",
          "weight": 0.55,
          "normalized": 1.0,
          "delta": 0.55
        },
        {
          "feature": "momentum_trail_lock_ratio",
          "weight": 0.4,
          "normalized": -0.48,
          "delta": -0.192
        }
      ],
      "reason": "sklearn_missing"
    }
  },
  "ema21_slope_1h": 0.0015280404143784606,
  "ema21_slope_threshold": 0.03,
  "ema21_relation_1h": "above",
  "last_swing_high_1h": 110411.24,
  "last_swing_low_1h": 110165.84,
  "last_close_1h": 110935.56,
  "bos_5m_dir": "bos_up",
  "atr1h": 678.4721428571439,
  "momentum_volume_ratio": null,
  "momentum_liquidity_ok": true,
  "dynamic_tp_profile": {
    "core": {
      "tp1": 1.4400000000000002,
      "tp2": 2.1600000000000006,
      "rr": 1.785
    },
    "momentum": {
      "tp1": 1.275,
      "tp2": 2.04,
      "rr": 1.4280000000000002
    },
    "regime": "compressed",
    "reference": {
      "current": 109.62785714285565,
      "q20": 129.08800000000107,
      "q50": 168.73142857142997,
      "q80": 245.76500000000277
    }
  },
  "order_flow_metrics": {
    "imbalance": null,
    "pressure": 0.0,
    "delta_volume": 0.0,
    "aggressor_ratio": null
  },
  "intraday_profile": {
    "asset": "BTCUSD",
    "timestamp": "2025-10-24T21:01:39Z",
    "day_start_utc": "2025-10-23T22:00:00Z",
    "day_open": 111597.48,
    "day_high": 111713.8,
    "day_low": 109725.51,
    "day_range": 1988.2900000000081,
    "range_vs_atr": 18.136722287740014,
    "range_position": 0.6085882844051914,
    "range_bias": "balanced",
    "range_state": "expansion",
    "range_compression": false,
    "range_expansion": true,
    "range_exhaustion_long": false,
    "range_exhaustion_short": false,
    "range_guard": {
      "long": false,
      "short": false
    },
    "opening_range_high": null,
    "opening_range_low": null,
    "opening_break": "none",
    "opening_range_minutes": 45,
    "opening_drive_ratio": null,
    "price_reference": 110935.56,
    "elapsed_minutes": 1381,
    "notes": [
      "Range expanzió >1.5×ATR — agresszív menedzsment indokolt."
    ]
  },
  "entry_thresholds": {
    "profile": "baseline",
    "atr_multiplier": 1.0,
    "atr_threshold_base": 40.0,
    "atr_threshold_initial": 40.0,
    "atr_threshold_effective": 40.0,
    "p_score_min_base": 60.0,
    "p_score_min_effective": 60.0
  },
  "volatility_overlay": {
    "implied_vol": null,
    "realised_vol": 0.0003909716374918409,
    "realised_window_minutes": 120,
    "regime": "suppressed",
    "premium": null,
    "source_path": null,
    "implied_realised_ratio": null
  },
  "invalid_levels": {
    "buy": 109826.60392857142,
    "sell": 110750.47607142858
  },
  "invalid_buffer_abs": 339.23607142857196,
  "action_plan": {
    "status": "standby",
    "priority": "low",
    "summary": "Állapot: market closed",
    "steps": [],
    "blockers": [
      "Piac zárva – várj a kereskedési ablakra.",
      "Trend filter nem támogatja az irányt.",
      "Nincs egyértelmű bias – várj megerősítésre.",
      "5m struktúra nem erősíti meg a setupot.",
      "Forgalmi feltételek nem teljesültek – várj nagyobb volumenre.",
      "ATR feltétel nem teljesült – volatilitás nem megfelelő.",
      "P_score>=60"
    ],
    "blockers_raw": [
      "session",
      "regime",
      "bias",
      "bos5m",
      "liquidity",
      "atr",
      "P_score>=60"
    ],
    "notes": [
      "Range expanzió >1.5×ATR — agresszív menedzsment indokolt.",
      "Összesített valószínűség: 0%.",
      "Ajánlott tőkeáttétel: ×2.0.",
      "Piac zárva (pénteki zárás 00:00 UTC)",
      "Bias neutrálsávban",
      "Regime filter inaktív",
      "ATR nincs rendben (relatív vagy abszolút küszöb)",
      "Alacsony realised vol → magasabb RR igény",
      "Range expanzió támogatja a momentumot (+3.0)"
    ],
    "context": {
      "asset": "BTCUSD",
      "decision": "market closed",
      "probability": 0,
      "session_open": false,
      "session_entry_open": false,
      "session_status": "closed_out_of_hours",
      "intraday_profile": {
        "range_state": "expansion",
        "range_position": 0.6085882844051914,
        "range_vs_atr": 18.136722287740014,
        "range_guard": {
          "long": false,
          "short": false
        },
        "opening_break": "none"
      },
      "next_session_open_utc": "2025-10-25T00:00:00+00:00"
    }
  },
  "active_position_meta": {
    "ema21_slope_abs": 0.0015280404143784606,
    "ema21_slope_signed": 0.0015280404143784606,
    "ema21_slope_threshold": 0.03,
    "ema21_relation": "above",
    "structure_5m": "bos_up",
    "stale_timeframes": {
      "k1m": true,
      "k5m": false,
      "k1h": false,
      "k4h": false
    },
    "atr1h": 678.4721428571439,
    "atr1h_trail_floor": 339.23607142857196,
    "atr5": 109.62785714285565,
    "atr5_rel": 0.0009882120497958964,
    "atr5_threshold": 40.0,
    "bos1h_long": true,
    "bos1h_short": false,
    "regime_ok": false,
    "effective_bias": "neutral",
    "last_close_1h": 110935.56,
    "last_swing_high_1h": 110411.24,
    "last_swing_low_1h": 110165.84,
    "invalid_level_sell": 110750.47607142858,
    "invalid_level_buy": 109826.60392857142,
    "invalid_buffer_abs": 339.23607142857196,
    "p_score": 0,
    "probability_calibrated": 0.010455248229670885,
    "probability_threshold": 0.6,
    "probability_model_raw": 0.05,
    "probability_model_source": "fallback",
    "tp_profile": {
      "tp1_r": 1.4400000000000002,
      "tp2_r": 2.1600000000000006
    },
    "realtime_confidence": 0.4532303370786517,
    "avg_latency_profile": 161.35,
    "probability_fallback": {
      "base_probability": 0.05,
      "adjusted_logit": -4.550140915395978,
      "probability": 0.010455248229670885,
      "threshold": 0.6,
      "steps": [
        {
          "feature": "bias_neutral_penalty",
          "weight": -0.55,
          "normalized": 1.0,
          "delta": -0.55
        },
        {
          "feature": "rel_atr",
          "weight": 0.35,
          "normalized": 0.2941060248979482,
          "delta": 0.10293710871428186
        },
        {
          "feature": "momentum_vol_ratio",
          "weight": 0.35,
          "normalized": -1.0,
          "delta": -0.35
        },
        {
          "feature": "news_event_severity",
          "weight": 0.25,
          "normalized": -0.5,
          "delta": -0.125
        },
        {
          "feature": "realtime_confidence",
          "weight": 0.9,
          "normalized": -0.22015449438202245,
          "delta": -0.1981390449438202
        },
        {
          "feature": "precision_score",
          "weight": 0.35,
          "normalized": -1.2,
          "delta": -0.42
        },
        {
          "feature": "precision_trigger_confidence",
          "weight": 0.55,
          "normalized": -0.77,
          "delta": -0.42350000000000004
        },
        {
          "feature": "structure_flip_flag",
          "weight": 0.55,
          "normalized": 1.0,
          "delta": 0.55
        },
        {
          "feature": "momentum_trail_lock_ratio",
          "weight": 0.4,
          "normalized": -0.48,
          "delta": -0.192
        }
      ],
      "reason": "sklearn_missing"
    },
    "anchor_side": "short",
    "anchor_price": 149.925003,
    "anchor_timestamp": "2025-10-17T10:59:39Z",
    "previous_p_score": 55.0,
    "action_plan": {
      "status": "standby",
      "priority": "low",
      "summary": "Állapot: market closed",
      "steps": [],
      "blockers": [
        "Piac zárva – várj a kereskedési ablakra.",
        "Trend filter nem támogatja az irányt.",
        "Nincs egyértelmű bias – várj megerősítésre.",
        "5m struktúra nem erősíti meg a setupot.",
        "Forgalmi feltételek nem teljesültek – várj nagyobb volumenre.",
        "ATR feltétel nem teljesült – volatilitás nem megfelelő.",
        "P_score>=60"
      ],
      "blockers_raw": [
        "session",
        "regime",
        "bias",
        "bos5m",
        "liquidity",
        "atr",
        "P_score>=60"
      ],
      "notes": [
        "Range expanzió >1.5×ATR — agresszív menedzsment indokolt.",
        "Összesített valószínűség: 0%.",
        "Ajánlott tőkeáttétel: ×2.0.",
        "Piac zárva (pénteki zárás 00:00 UTC)",
        "Bias neutrálsávban",
        "Regime filter inaktív",
        "ATR nincs rendben (relatív vagy abszolút küszöb)",
        "Alacsony realised vol → magasabb RR igény",
        "Range expanzió támogatja a momentumot (+3.0)"
      ],
      "context": {
        "asset": "BTCUSD",
        "decision": "market closed",
        "probability": 0,
        "session_open": false,
        "session_entry_open": false,
        "session_status": "closed_out_of_hours",
        "intraday_profile": {
          "range_state": "expansion",
          "range_position": 0.6085882844051914,
          "range_vs_atr": 18.136722287740014,
          "range_guard": {
            "long": false,
            "short": false
          },
          "opening_break": "none"
        },
        "next_session_open_utc": "2025-10-25T00:00:00+00:00"
      }
    }
  },
  "intervention_watch": {
    "irs": 0,
    "band": "LOW",
    "since_utc": "2025-10-24T20:44:33Z",
    "updated_utc": "2025-10-24T21:01:39Z",
    "reasons": [],
    "policy": [
      "increase_spread_buffer_when_volatility>=1.5×",
      "discord_alert_cooldown:10m"
    ],
    "metrics": {
      "price": 110935.56,
      "roc_30m_pct": 0.1492820271155966,
      "roc_5m_pct": 0.06186693836766397,
      "atr5_usd": 109.62785714285565,
      "atr5_ratio": 0.7804400555281484,
      "range_position_pct": 55.75516140937403,
      "session_points": 0.0,
      "comms_points": 0.0,
      "comms_from_flag": 0.0,
      "comms_from_sentiment": 0.0,
      "sentiment_score": null,
      "components": {
        "speed": 0.0,
        "volatility": 0.0,
        "range": 0.0,
        "comms": 0.0
      },
      "variance_ratio": 0.3154031906704844
    },
    "score_breakdown": {
      "speed": 0.0,
      "volatility": 0.0,
      "range": 0.0,
      "comms": 0.0
    },
    "news_flag": 0
  }
}