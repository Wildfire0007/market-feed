{
  "asset": "BTCUSD",
  "ok": true,
  "retrieved_at_utc": "2025-11-01T17:47:15Z",
  "source": "Twelve Data (lokális JSON)",
  "spot": {
    "price": 110305.0,
    "utc": "2025-11-01T17:45:20+00:00",
    "retrieved_at_utc": "2025-11-01T17:45:20+00:00",
    "source": "twelvedata:quote",
    "realtime_override": false,
    "fallback_used": false,
    "confidence": 1.0,
    "avg_latency_profile": 116.3169770354423,
    "realtime_stats": {
      "samples": 1,
      "min_price": 111511.51,
      "max_price": 111511.51,
      "mean_price": 111511.51,
      "latency_avg": 0.0,
      "latency_max": 0.0,
      "latency_median": 0.0,
      "latency_latest": 0.0
    }
  },
  "signal": "no entry",
  "probability": 21,
  "probability_raw": 21,
  "entry": null,
  "sl": null,
  "tp1": null,
  "tp2": null,
  "rr": null,
  "leverage": 2,
  "position_size_scale": 0.75,
  "range_time_stop": null,
  "funding_filter": null,
  "funding_rate": null,
  "stale_timeframes": {
    "k1m": false,
    "k5m": false,
    "k1h": false,
    "k4h": false
  },
  "biases": {
    "raw_4h": "short",
    "raw_1h": "neutral",
    "adjusted_4h": "short",
    "adjusted_1h": "neutral"
  },
  "gates": {
    "mode": "momentum",
    "required": [
      "session",
      "regime",
      "bias",
      "momentum_trigger",
      "structure(2of3)",
      "atr",
      "rr_math>=1.4",
      "tp_min_profit",
      "min_stoploss",
      "tp1_net>=+115%",
      "intraday_range_guard"
    ],
    "missing": [
      "regime",
      "bias",
      "atr",
      "momentum_trigger",
      "ofi"
    ],
    "intraday_bias": {
      "configured": true,
      "allow_neutral": true,
      "scenarios": [
        {
          "direction": "long",
          "requires": [
            "micro_bos_long",
            "momentum_volume",
            "atr_ok"
          ],
          "missing": [
            "micro_bos_long",
            "momentum_volume",
            "atr_ok"
          ],
          "met": false,
          "label": "Crypto momentum long",
          "missing_pretty": [
            "1m micro BOS long",
            "Momentum volume ráta",
            "ATR gate"
          ],
          "requires_pretty": [
            "1m micro BOS long",
            "Momentum volume ráta",
            "ATR gate"
          ]
        },
        {
          "direction": "short",
          "requires": [
            "micro_bos_short",
            "momentum_volume",
            "atr_ok"
          ],
          "missing": [
            "micro_bos_short",
            "momentum_volume",
            "atr_ok"
          ],
          "met": false,
          "label": "Crypto momentum short",
          "missing_pretty": [
            "1m micro BOS short",
            "Momentum volume ráta",
            "ATR gate"
          ],
          "requires_pretty": [
            "1m micro BOS short",
            "Momentum volume ráta",
            "ATR gate"
          ]
        }
      ],
      "matched": false
    }
  },
  "session_info": {
    "open": true,
    "entry_open": true,
    "within_window": true,
    "within_entry_window": true,
    "within_monitor_window": true,
    "weekday_ok": true,
    "now_utc": "2025-11-01T17:47:15.840106+00:00",
    "windows_utc": [
      [
        0,
        0,
        23,
        59
      ]
    ],
    "time_zone": "Europe/Berlin",
    "windows_local_cet": [
      [
        "01:00",
        "00:59"
      ]
    ],
    "status": "open",
    "status_note": "Piac nyitva"
  },
  "diagnostics": {
    "timeframes": {
      "k1m": {
        "last_raw_utc": "2025-11-01T17:44:00Z",
        "last_closed_utc": "2025-11-01T17:44:00Z",
        "latency_seconds": 195,
        "expected_max_delay_seconds": 180,
        "source_mtime_utc": "2025-11-01T17:46:53Z",
        "stale_for_signals": false,
        "freshness_limit_seconds": 420.0,
        "freshness_violation": false,
        "freshness_retries": 0,
        "used_symbol": "BTC/USD",
        "used_exchange": "Coinbase Pro",
        "critical_stale": false
      },
      "k5m": {
        "last_raw_utc": "2025-11-01T17:40:00Z",
        "last_closed_utc": "2025-11-01T17:40:00Z",
        "latency_seconds": 435,
        "expected_max_delay_seconds": 300,
        "source_mtime_utc": "2025-11-01T17:46:53Z",
        "stale_for_signals": false,
        "freshness_limit_seconds": 1200.0,
        "freshness_violation": false,
        "freshness_retries": 0,
        "used_symbol": "BTC/USD",
        "used_exchange": "Coinbase Pro",
        "critical_stale": false
      },
      "k1h": {
        "last_raw_utc": "2025-11-01T17:00:00Z",
        "last_closed_utc": "2025-11-01T17:00:00Z",
        "latency_seconds": 2835,
        "expected_max_delay_seconds": 3600,
        "source_mtime_utc": "2025-11-01T17:46:53Z",
        "stale_for_signals": false,
        "freshness_limit_seconds": 9000.0,
        "freshness_violation": false,
        "freshness_retries": 0,
        "used_symbol": "BTC/USD",
        "used_exchange": "Coinbase Pro",
        "critical_stale": false
      },
      "k4h": {
        "last_raw_utc": "2025-11-01T16:00:00Z",
        "last_closed_utc": "2025-11-01T16:00:00Z",
        "latency_seconds": 6435,
        "expected_max_delay_seconds": 14400,
        "source_mtime_utc": "2025-11-01T17:46:53Z",
        "stale_for_signals": false,
        "freshness_limit_seconds": 36000.0,
        "freshness_violation": false,
        "freshness_retries": 0,
        "used_symbol": "BTC/USD",
        "used_exchange": "Coinbase Pro",
        "critical_stale": false
      },
      "spot": {
        "last_raw_utc": "2025-11-01T17:45:20Z",
        "latency_seconds": 115,
        "expected_max_delay_seconds": 300,
        "source_mtime_utc": "2025-11-01T17:46:53Z",
        "source": "twelvedata:quote",
        "fallback_used": false,
        "realtime_override": false,
        "freshness_limit_seconds": 300.0,
        "freshness_retries": 0,
        "freshness_violation": false,
        "freshness_violation_meta": false,
        "used_symbol": "BTC/USD",
        "used_exchange": "Coinbase Pro",
        "realtime_forced": true,
        "realtime_force_reason": "spot_error"
      }
    },
    "source_files": {
      "spot.json": "2025-11-01T17:46:53Z",
      "klines_1m.json": "2025-11-01T17:46:53Z",
      "klines_5m.json": "2025-11-01T17:46:53Z",
      "klines_1h.json": "2025-11-01T17:46:53Z",
      "klines_4h.json": "2025-11-01T17:46:53Z"
    },
    "latency_flags": [
      "spot: realtime mintavétel kényszerítve (spot_error)"
    ],
    "refresh_tips": [
      "Az analysis.py mindig a legutóbbi ZÁRT gyertyával számol (5m: max. ~5 perc késés).",
      "CI/CD-ben kösd össze a Trading és Analysis futást: az analysis job csak a trading után induljon (needs: trading).",
      "A kliens kéréséhez adj cache-busting query paramot (pl. ?v=<timestamp>) és no-store cache-control fejlécet.",
      "Cloudflare Worker stale policy: 5m feedre állítsd 120s-re, hogy hamar átjöjjön az új jel.",
      "A dashboard stabilizáló (2 azonos jel + 10 perc cooldown) lassíthatja a kártya frissítését — lazítsd, ha realtime kell."
    ]
  },
  "reasons": [
    "Intraday bias gate feltételek hiányosak — Crypto momentum long: 1m micro BOS long, Momentum volume ráta, ATR gate | Crypto momentum short: 1m micro BOS short, Momentum volume ráta, ATR gate",
    "Bias neutrálsávban",
    "Regime filter inaktív",
    "Spread gate: aktuális spread meghaladja az ATR arány limitet",
    "ATR nincs rendben (relatív vagy abszolút küszöb)",
    "Alacsony realised vol → magasabb RR igény",
    "Fib zóna konfluencia (0.618–0.886) (+18.0)",
    "Diagnosztika: spot: realtime mintavétel kényszerítve (spot_error)",
    "Pozíciómenedzsment: aktív short pozíció invalidálódott → hard exit szükséges (strukturális invalid szint elesett) (aktív short pozíció, nyitva: 2025-10-17 12:59 helyi idő; 1h ATR ≈ 309.0)",
    "missing: regime, bias, atr, momentum_trigger, ofi"
  ],
  "realtime_transport": "http",
  "probability_model_source": "sklearn",
  "probability_model": null,
  "probability_model_raw": null,
  "probability_calibrated": null,
  "probability_threshold": null,
  "probability_stack": {
    "source": "sklearn",
    "status": "disabled",
    "unavailable_reason": "ml_scoring_disabled"
  },
  "ema21_slope_1h": 0.0023834202255463535,
  "ema21_slope_threshold": 0.03,
  "ema21_relation_1h": "above",
  "last_swing_high_1h": 110166.0,
  "last_swing_low_1h": 109851.85,
  "last_close_1h": 110245.17,
  "bos_5m_dir": "bos_down",
  "atr1h": 309.0064285714304,
  "momentum_volume_ratio": null,
  "momentum_liquidity_ok": true,
  "dynamic_tp_profile": {
    "core": {
      "tp1": 2.0,
      "tp2": 3.0,
      "rr": 1.7
    },
    "momentum": {
      "tp1": 1.5,
      "tp2": 2.4,
      "rr": 1.4
    },
    "regime": "normal",
    "reference": {
      "current": 100.04857142856989,
      "q20": 72.09742857142639,
      "q50": 102.37785714285461,
      "q80": 141.9967142857125
    }
  },
  "order_flow_metrics": {
    "imbalance": null,
    "pressure": 0.0,
    "delta_volume": 0.0,
    "aggressor_ratio": null,
    "imbalance_z": null
  },
  "intraday_profile": {
    "asset": "BTCUSD",
    "timestamp": "2025-11-01T17:47:15Z",
    "day_start_utc": "2025-10-31T23:00:00Z",
    "day_open": 110084.17,
    "day_high": 110493.52,
    "day_low": 109608.28,
    "day_range": 885.2400000000052,
    "range_vs_atr": 8.848102350287192,
    "range_position": 0.7870408024942355,
    "range_bias": "upper",
    "range_state": "expansion",
    "range_compression": false,
    "range_expansion": true,
    "range_exhaustion_long": false,
    "range_exhaustion_short": false,
    "range_guard": {
      "long": false,
      "short": false
    },
    "opening_range_high": null,
    "opening_range_low": null,
    "opening_break": "none",
    "opening_range_minutes": 45,
    "opening_drive_ratio": null,
    "previous_close": null,
    "opening_gap": null,
    "opening_gap_pct": null,
    "opening_gap_direction": "flat",
    "price_reference": 110305.0,
    "elapsed_minutes": 1127,
    "notes": [
      "Range expanzió >1.5×ATR — agresszív menedzsment indokolt."
    ]
  },
  "entry_thresholds": {
    "profile": "suppressed",
    "btc_profile": "suppressed",
    "news_lockout": false,
    "btc_ofi_thresholds": {
      "trigger": 0.8,
      "strong": 1.1,
      "weakening": -0.4
    },
    "adx_value": 20.814227335406247,
    "adx_trend_threshold": 22.0,
    "adx_regime_initial": "range",
    "btc_rr_adx": {
      "profile": "suppressed",
      "rr_min": 1.7,
      "mode": "trend"
    },
    "btc_atr_floor_usd": 40.0,
    "btc_atr_floor_ratio": 0.00036263088708580755,
    "btc_atr_floor_passed": true,
    "btc_atr_gate_threshold_usd": 40.0,
    "btc_atr_value_usd": 100.04857142856989,
    "btc_atr_gate_ok": true,
    "atr_multiplier": 0.95,
    "atr_threshold_base": 0.0004,
    "atr_threshold_initial": 0.00038,
    "atr_intraday_relax": 0.85,
    "atr_threshold_intraday": 0.000323,
    "atr_percentile_meta": {
      "bucket": "close",
      "samples": 95,
      "profile": "suppressed",
      "percentile": 0.35,
      "threshold": 0.0011724336716684859
    },
    "atr_threshold_percentile": 0.0011724336716684859,
    "spread_ratio": 12.0592426535684,
    "spread_limit_atr": 0.4,
    "atr_threshold_effective": 0.0011724336716684859,
    "spread_gate_ok": false,
    "btc_atr_ratio": 0.7736195037195398,
    "btc_volume_ratio": 0.0,
    "btc_range_expansion": true,
    "btc_momentum_cross": false,
    "btc_momentum_ofi_ok": false,
    "btc_momentum_atr_ok": false,
    "ofi_z": null,
    "vwap_confluence": {
      "trend_pullback": false,
      "mean_revert": false
    },
    "btc_core_triggers": {
      "bos_ok": false,
      "vwap_ok": false,
      "ofi_ok": false,
      "ofi_z": null,
      "hits": 0
    },
    "btc_structure_combo": {
      "active_direction": null,
      "active": {
        "micro": false,
        "vwap": false,
        "ofi": false,
        "count": 0
      },
      "combos": {
        "long": {
          "micro": false,
          "vwap": false,
          "ofi": false,
          "price_above_vwap": false,
          "price_below_vwap": false
        },
        "short": {
          "micro": false,
          "vwap": false,
          "ofi": false,
          "price_above_vwap": false,
          "price_below_vwap": false
        }
      },
      "either_of_ok": false
    },
    "structure_components": {
      "bos": false,
      "liquidity": false,
      "ofi": false
    },
    "btc_momentum_override": false,
    "p_score_min_profile_override": {
      "profile": "suppressed",
      "value": 44.0
    },
    "p_score_min_base": 44.0,
    "p_score_min_effective": 44.0,
    "adx_regime": "trend",
    "btc_position_scale": 0.75,
    "position_size_scale": 0.75,
    "precision_score_threshold": 50.0,
    "precision_timeouts": {
      "ready": 15,
      "arming": 20
    }
  },
  "volatility_overlay": {
    "implied_vol": null,
    "realised_vol": 0.0003100113782902061,
    "realised_window_minutes": 120,
    "regime": "suppressed",
    "premium": null,
    "source_path": null,
    "implied_realised_ratio": null
  },
  "invalid_levels": {
    "buy": 109697.3467857143,
    "sell": 110320.50321428571
  },
  "invalid_buffer_abs": 154.5032142857152,
  "position_management": "Pozíciómenedzsment: aktív short pozíció invalidálódott → hard exit szükséges (strukturális invalid szint elesett) (aktív short pozíció, nyitva: 2025-10-17 12:59 helyi idő; 1h ATR ≈ 309.0)",
  "position_exit_signal": {
    "state": "hard_exit",
    "severity": "critical",
    "action": "close",
    "reasons": [
      "strukturális invalid szint elesett"
    ],
    "trigger_price": 110305.0,
    "triggered_at": "2025-11-01T17:47:15Z",
    "actions": [
      {
        "type": "close",
        "size": 1.0,
        "urgency": "immediate"
      }
    ],
    "category": "structural_invalid",
    "entry_price": 149.925003,
    "direction": "short"
  },
  "action_plan": {
    "status": "manage_position",
    "priority": "high",
    "summary": "Kritikus jelzés: hard exit (short)",
    "steps": [
      {
        "order": 1,
        "category": "exit",
        "instruction": "Zárd a teljes pozíciót (sürgősség: azonnal)",
        "source": "position_exit_signal",
        "type": "close",
        "size": 1.0,
        "urgency": "immediate"
      }
    ],
    "blockers": [
      "Trend filter nem támogatja az irányt.",
      "Nincs egyértelmű bias – várj megerősítésre.",
      "ATR feltétel nem teljesült – volatilitás nem megfelelő.",
      "Momentum trigger még nem aktív.",
      "ofi",
      "BTC trigger feltételek hiányosak."
    ],
    "blockers_raw": [
      "regime",
      "bias",
      "atr",
      "momentum_trigger",
      "ofi",
      "triggers"
    ],
    "notes": [
      "Belépési döntés – összefogás: mód: nincs; ATR kapu: OK; core trigger: hiányzik; momentum override: inaktív; RR min: 1.70",
      "Range expanzió >1.5×ATR — agresszív menedzsment indokolt.",
      "Összesített valószínűség: 21%.",
      "Ajánlott tőkeáttétel: ×2.0.",
      "Pozíciómenedzsment: aktív short pozíció invalidálódott → hard exit szükséges (strukturális invalid szint elesett) (aktív short pozíció, nyitva: 2025-10-17 12:59 helyi idő; 1h ATR ≈ 309.0)",
      "Intraday bias gate feltételek hiányosak — Crypto momentum long: 1m micro BOS long, Momentum volume ráta, ATR gate | Crypto momentum short: 1m micro BOS short, Momentum volume ráta, ATR gate",
      "Bias neutrálsávban",
      "Regime filter inaktív",
      "Spread gate: aktuális spread meghaladja az ATR arány limitet",
      "ATR nincs rendben (relatív vagy abszolút küszöb)",
      "Alacsony realised vol → magasabb RR igény",
      "strukturális invalid szint elesett"
    ],
    "context": {
      "asset": "BTCUSD",
      "decision": "no entry",
      "probability": 21,
      "session_open": true,
      "session_entry_open": true,
      "session_status": "open",
      "intraday_profile": {
        "range_state": "expansion",
        "range_position": 0.7870408024942355,
        "range_vs_atr": 8.848102350287192,
        "range_guard": {
          "long": false,
          "short": false
        },
        "opening_break": "none"
      },
      "btc_entry_summary": {
        "profile": "suppressed",
        "enter_mode": null,
        "atr_gate": {
          "ok": true,
          "value": 100.04857142856989,
          "threshold": 40.0
        },
        "core_triggers": {
          "ok": false
        },
        "momentum_override": {
          "ok": false,
          "rr_min": null,
          "note": null
        },
        "rr_min_effective": 1.7,
        "rr_from_adx": 1.7,
        "rr_info": {
          "mode": "trend"
        },
        "blockers": [
          "triggers"
        ]
      }
    }
  },
  "active_position_meta": {
    "ema21_slope_abs": 0.0023834202255463535,
    "ema21_slope_signed": 0.0023834202255463535,
    "ema21_slope_threshold": 0.03,
    "ema21_relation": "above",
    "structure_5m": "bos_down",
    "stale_timeframes": {
      "k1m": false,
      "k5m": false,
      "k1h": false,
      "k4h": false
    },
    "atr1h": 309.0064285714304,
    "atr1h_trail_floor": 154.5032142857152,
    "atr5": 100.04857142856989,
    "atr5_rel": 0.0009070175552202519,
    "atr5_threshold": 0.0011724336716684859,
    "bos1h_long": true,
    "bos1h_short": false,
    "regime_ok": false,
    "effective_bias": "neutral",
    "last_close_1h": 110245.17,
    "last_swing_high_1h": 110166.0,
    "last_swing_low_1h": 109851.85,
    "invalid_level_sell": 110320.50321428571,
    "invalid_level_buy": 109697.3467857143,
    "invalid_buffer_abs": 154.5032142857152,
    "p_score": 21,
    "probability_calibrated": null,
    "probability_threshold": null,
    "probability_model_raw": null,
    "probability_model_source": "sklearn",
    "tp_profile": {
      "tp1_r": 2.0,
      "tp2_r": 3.0
    },
    "realtime_confidence": 1.0,
    "avg_latency_profile": 116.3169770354423,
    "realtime_stats": {
      "samples": 1,
      "min_price": 111511.51,
      "max_price": 111511.51,
      "mean_price": 111511.51,
      "latency_avg": 0.0,
      "latency_max": 0.0,
      "latency_median": 0.0,
      "latency_latest": 0.0
    },
    "anchor_side": "short",
    "anchor_price": 149.925003,
    "anchor_timestamp": "2025-10-17T10:59:39Z",
    "previous_p_score": 21.0,
    "action_plan": {
      "status": "manage_position",
      "priority": "high",
      "summary": "Kritikus jelzés: hard exit (short)",
      "steps": [
        {
          "order": 1,
          "category": "exit",
          "instruction": "Zárd a teljes pozíciót (sürgősség: azonnal)",
          "source": "position_exit_signal",
          "type": "close",
          "size": 1.0,
          "urgency": "immediate"
        }
      ],
      "blockers": [
        "Trend filter nem támogatja az irányt.",
        "Nincs egyértelmű bias – várj megerősítésre.",
        "ATR feltétel nem teljesült – volatilitás nem megfelelő.",
        "Momentum trigger még nem aktív.",
        "ofi",
        "BTC trigger feltételek hiányosak."
      ],
      "blockers_raw": [
        "regime",
        "bias",
        "atr",
        "momentum_trigger",
        "ofi",
        "triggers"
      ],
      "notes": [
        "Belépési döntés – összefogás: mód: nincs; ATR kapu: OK; core trigger: hiányzik; momentum override: inaktív; RR min: 1.70",
        "Range expanzió >1.5×ATR — agresszív menedzsment indokolt.",
        "Összesített valószínűség: 21%.",
        "Ajánlott tőkeáttétel: ×2.0.",
        "Pozíciómenedzsment: aktív short pozíció invalidálódott → hard exit szükséges (strukturális invalid szint elesett) (aktív short pozíció, nyitva: 2025-10-17 12:59 helyi idő; 1h ATR ≈ 309.0)",
        "Intraday bias gate feltételek hiányosak — Crypto momentum long: 1m micro BOS long, Momentum volume ráta, ATR gate | Crypto momentum short: 1m micro BOS short, Momentum volume ráta, ATR gate",
        "Bias neutrálsávban",
        "Regime filter inaktív",
        "Spread gate: aktuális spread meghaladja az ATR arány limitet",
        "ATR nincs rendben (relatív vagy abszolút küszöb)",
        "Alacsony realised vol → magasabb RR igény",
        "strukturális invalid szint elesett"
      ],
      "context": {
        "asset": "BTCUSD",
        "decision": "no entry",
        "probability": 21,
        "session_open": true,
        "session_entry_open": true,
        "session_status": "open",
        "intraday_profile": {
          "range_state": "expansion",
          "range_position": 0.7870408024942355,
          "range_vs_atr": 8.848102350287192,
          "range_guard": {
            "long": false,
            "short": false
          },
          "opening_break": "none"
        },
        "btc_entry_summary": {
          "profile": "suppressed",
          "enter_mode": null,
          "atr_gate": {
            "ok": true,
            "value": 100.04857142856989,
            "threshold": 40.0
          },
          "core_triggers": {
            "ok": false
          },
          "momentum_override": {
            "ok": false,
            "rr_min": null,
            "note": null
          },
          "rr_min_effective": 1.7,
          "rr_from_adx": 1.7,
          "rr_info": {
            "mode": "trend"
          },
          "blockers": [
            "triggers"
          ]
        }
      }
    },
    "exit_signal": {
      "state": "hard_exit",
      "severity": "critical",
      "action": "close",
      "reasons": [
        "strukturális invalid szint elesett"
      ],
      "trigger_price": 110305.0,
      "triggered_at": "2025-11-01T17:47:15Z",
      "actions": [
        {
          "type": "close",
          "size": 1.0,
          "urgency": "immediate"
        }
      ],
      "category": "structural_invalid",
      "entry_price": 149.925003,
      "direction": "short"
    }
  },
  "intervention_watch": {
    "irs": 10,
    "band": "LOW",
    "since_utc": "2025-10-24T20:44:33Z",
    "updated_utc": "2025-11-01T17:47:15Z",
    "reasons": [],
    "policy": [
      "increase_spread_buffer_when_volatility>=1.5×",
      "discord_alert_cooldown:10m"
    ],
    "metrics": {
      "price": 110245.17,
      "roc_30m_pct": 0.005324212814677615,
      "roc_5m_pct": 0.03834524795476126,
      "atr5_usd": 100.04857142856989,
      "atr5_ratio": 0.9193709304767915,
      "range_position_pct": 84.11809065583056,
      "session_points": 0.0,
      "comms_points": 0.0,
      "comms_from_flag": 0.0,
      "comms_from_sentiment": 0.0,
      "sentiment_score": null,
      "components": {
        "speed": 0.0,
        "volatility": 0.0,
        "range": 10.0,
        "comms": 0.0
      },
      "variance_ratio": 0.200575483115255
    },
    "score_breakdown": {
      "speed": 0.0,
      "volatility": 0.0,
      "range": 10.0,
      "comms": 0.0
    },
    "news_flag": 0
  }
}